{"mappings":"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","sources":["src/lazy/image-service.js","node_modules/image-blob-reduce/dist/image-blob-reduce.esm.mjs"],"sourcesContent":["const reduceImport = require(\"image-blob-reduce\");\nconst reduce = reduceImport.default();\nconst imageService = {\n  handleImage: (source, callback) => {\n    let fileSize = source.size;\n    try {\n      // don't use image reduction for iOS as it's problematic.\n      // TODO: Find a fix and test those platforms.\n      let iOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\n      if (iOS) {\n        console.warn(\"Do not use image reduction on iOS !\");\n        callback(source);\n        return;\n      }\n      if (!source.type || !source.type.match(/image/)) {\n        console.warn(\"Do not use image reduction on invalid file !\");\n        callback(source);\n        return;\n      }\n      if (source.type == \"image/gif\") {\n        console.warn(\"Do not use image reduction on a gif !\");\n        callback(source);\n        return;\n      }\n      if (fileSize < 1024 * 256) {\n        console.warn(\"Do not use image reduction on small file !\");\n        callback(source);\n        return;\n      }\n      reduce.toBlob(source, {max: 2048, unsharpAmount: 100, unsharpRadius: 1, quality: 2}).then(blob => callback(blob));\n    } catch (error) {\n      // TODO error logging\n      console.warn(error);\n      // If something goes wrong in image reduction, fall back to normal upload\n      callback(source);\n    }\n  }\n};\nexport default imageService;\n","\n/*! image-blob-reduce 3.0.1 https://github.com/nodeca/image-blob-reduce @license MIT */\nvar assign$1 = function assign(to) {\n  var from;\n\n  for (var s = 1; s < arguments.length; s++) {\n    from = Object(arguments[s]);\n\n    for (var key in from) {\n      if (Object.prototype.hasOwnProperty.call(from, key)) to[key] = from[key];\n    }\n  }\n\n  return to;\n};\n\n\nfunction pick(from, props) {\n  var to = {};\n\n  props.forEach(function (key) {\n    if (Object.prototype.hasOwnProperty.call(from, key)) to[key] = from[key];\n  });\n\n  return to;\n}\n\n\nfunction pick_pica_resize_options(from) {\n  return pick(from, [\n    'alpha',\n    'unsharpAmount',\n    'unsharpRadius',\n    'unsharpThreshold',\n    'cancelToken'\n  ]);\n}\n\n\nvar pick_1 = pick;\nvar pick_pica_resize_options_1 = pick_pica_resize_options;\n\nvar utils = {\n\tassign: assign$1,\n\tpick: pick_1,\n\tpick_pica_resize_options: pick_pica_resize_options_1\n};\n\nfunction createCommonjsModule(fn) {\n  var module = { exports: {} };\n\treturn fn(module, module.exports), module.exports;\n}\n\nfunction commonjsRequire (target) {\n\tthrow new Error('Could not dynamically require \"' + target + '\". Please configure the dynamicRequireTargets option of @rollup/plugin-commonjs appropriately for this require call to behave properly.');\n}\n\n/*!\n\npica\nhttps://github.com/nodeca/pica\n\n*/\n\nvar pica = createCommonjsModule(function (module, exports) {\n(function(f){{module.exports=f();}})(function(){return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof commonjsRequire&&commonjsRequire;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t);}return n[i].exports}for(var u=\"function\"==typeof commonjsRequire&&commonjsRequire,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(_dereq_,module,exports){\n\nvar inherits = _dereq_('inherits');\n\nvar Multimath = _dereq_('multimath');\n\nvar mm_unsharp_mask = _dereq_('./mm_unsharp_mask');\n\nvar mm_resize = _dereq_('./mm_resize');\n\nfunction MathLib(requested_features) {\n  var __requested_features = requested_features || [];\n\n  var features = {\n    js: __requested_features.indexOf('js') >= 0,\n    wasm: __requested_features.indexOf('wasm') >= 0\n  };\n  Multimath.call(this, features);\n  this.features = {\n    js: features.js,\n    wasm: features.wasm && this.has_wasm()\n  };\n  this.use(mm_unsharp_mask);\n  this.use(mm_resize);\n}\n\ninherits(MathLib, Multimath);\n\nMathLib.prototype.resizeAndUnsharp = function resizeAndUnsharp(options, cache) {\n  var result = this.resize(options, cache);\n\n  if (options.unsharpAmount) {\n    this.unsharp_mask(result, options.toWidth, options.toHeight, options.unsharpAmount, options.unsharpRadius, options.unsharpThreshold);\n  }\n\n  return result;\n};\n\nmodule.exports = MathLib;\n\n},{\"./mm_resize\":4,\"./mm_unsharp_mask\":9,\"inherits\":19,\"multimath\":20}],2:[function(_dereq_,module,exports){\n//var FIXED_FRAC_BITS = 14;\n\nfunction clampTo8(i) {\n  return i < 0 ? 0 : i > 255 ? 255 : i;\n} // Convolve image in horizontal directions and transpose output. In theory,\n// transpose allow:\n//\n// - use the same convolver for both passes (this fails due different\n//   types of input array and temporary buffer)\n// - making vertical pass by horisonltal lines inprove CPU cache use.\n//\n// But in real life this doesn't work :)\n//\n\n\nfunction convolveHorizontally(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Bring this value back in range. All of the filter scaling factors\n      // are in fixed point with FIXED_FRAC_BITS bits of fractional part.\n      //\n      // (!) Add 1/2 of value before clamping to get proper rounding. In other\n      // case brightness loss will be noticeable if you resize image with white\n      // border and place it on white background.\n      //\n\n\n      dest[destOffset + 3] = clampTo8(a + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      dest[destOffset + 2] = clampTo8(b + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      dest[destOffset + 1] = clampTo8(g + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      dest[destOffset] = clampTo8(r + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n} // Technically, convolvers are the same. But input array and temporary\n// buffer can be of different type (especially, in old browsers). So,\n// keep code in separate functions to avoid deoptimizations & speed loss.\n\n\nfunction convolveVertically(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Bring this value back in range. All of the filter scaling factors\n      // are in fixed point with FIXED_FRAC_BITS bits of fractional part.\n      //\n      // (!) Add 1/2 of value before clamping to get proper rounding. In other\n      // case brightness loss will be noticeable if you resize image with white\n      // border and place it on white background.\n      //\n\n\n      dest[destOffset + 3] = clampTo8(a + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      dest[destOffset + 2] = clampTo8(b + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      dest[destOffset + 1] = clampTo8(g + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      dest[destOffset] = clampTo8(r + (1 << 13) >> 14\n      /*FIXED_FRAC_BITS*/\n      );\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n}\n\nmodule.exports = {\n  convolveHorizontally: convolveHorizontally,\n  convolveVertically: convolveVertically\n};\n\n},{}],3:[function(_dereq_,module,exports){\n/* eslint-disable max-len */\n\nmodule.exports = 'AGFzbQEAAAAADAZkeWxpbmsAAAAAAAEXA2AAAGAGf39/f39/AGAHf39/f39/fwACDwEDZW52Bm1lbW9yeQIAAAMEAwABAgYGAX8AQQALB1cFEV9fd2FzbV9jYWxsX2N0b3JzAAAIY29udm9sdmUAAQpjb252b2x2ZUhWAAIMX19kc29faGFuZGxlAwAYX193YXNtX2FwcGx5X2RhdGFfcmVsb2NzAAAK7AMDAwABC8YDAQ9/AkAgA0UNACAERQ0AA0AgDCENQQAhE0EAIQcDQCAHQQJqIQYCfyAHQQF0IAVqIgcuAQIiFEUEQEGAwAAhCEGAwAAhCUGAwAAhCkGAwAAhCyAGDAELIBIgBy4BAGohCEEAIQsgFCEHQQAhDiAGIQlBACEPQQAhEANAIAUgCUEBdGouAQAiESAAIAhBAnRqKAIAIgpBGHZsIBBqIRAgCkH/AXEgEWwgC2ohCyAKQRB2Qf8BcSARbCAPaiEPIApBCHZB/wFxIBFsIA5qIQ4gCEEBaiEIIAlBAWohCSAHQQFrIgcNAAsgC0GAQGshCCAOQYBAayEJIA9BgEBrIQogEEGAQGshCyAGIBRqCyEHIAEgDUECdGogCUEOdSIGQf8BIAZB/wFIGyIGQQAgBkEAShtBCHRBgP4DcSAKQQ51IgZB/wEgBkH/AUgbIgZBACAGQQBKG0EQdEGAgPwHcSALQQ51IgZB/wEgBkH/AUgbIgZBACAGQQBKG0EYdHJyIAhBDnUiBkH/ASAGQf8BSBsiBkEAIAZBAEobcjYCACADIA1qIQ0gE0EBaiITIARHDQALIAxBAWoiDCACbCESIAMgDEcNAAsLCx4AQQAgAiADIAQgBSAAEAEgAkEAIAQgBSAGIAEQAQs=';\n\n},{}],4:[function(_dereq_,module,exports){\n\nmodule.exports = {\n  name: 'resize',\n  fn: _dereq_('./resize'),\n  wasm_fn: _dereq_('./resize_wasm'),\n  wasm_src: _dereq_('./convolve_wasm_base64')\n};\n\n},{\"./convolve_wasm_base64\":3,\"./resize\":5,\"./resize_wasm\":8}],5:[function(_dereq_,module,exports){\n\nvar createFilters = _dereq_('./resize_filter_gen');\n\nvar convolveHorizontally = _dereq_('./convolve').convolveHorizontally;\n\nvar convolveVertically = _dereq_('./convolve').convolveVertically;\n\nfunction resetAlpha(dst, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    dst[ptr] = 0xFF;\n    ptr = ptr + 4 | 0;\n  }\n}\n\nmodule.exports = function resize(options) {\n  var src = options.src;\n  var srcW = options.width;\n  var srcH = options.height;\n  var destW = options.toWidth;\n  var destH = options.toHeight;\n  var scaleX = options.scaleX || options.toWidth / options.width;\n  var scaleY = options.scaleY || options.toHeight / options.height;\n  var offsetX = options.offsetX || 0;\n  var offsetY = options.offsetY || 0;\n  var dest = options.dest || new Uint8Array(destW * destH * 4);\n  var quality = typeof options.quality === 'undefined' ? 3 : options.quality;\n  var alpha = options.alpha || false;\n  var filtersX = createFilters(quality, srcW, destW, scaleX, offsetX),\n      filtersY = createFilters(quality, srcH, destH, scaleY, offsetY);\n  var tmp = new Uint8Array(destW * srcH * 4); // To use single function we need src & tmp of the same type.\n  // But src can be CanvasPixelArray, and tmp - Uint8Array. So, keep\n  // vertical and horizontal passes separately to avoid deoptimization.\n\n  convolveHorizontally(src, tmp, srcW, srcH, destW, filtersX);\n  convolveVertically(tmp, dest, srcH, destW, destH, filtersY); // That's faster than doing checks in convolver.\n  // !!! Note, canvas data is not premultipled. We don't need other\n  // alpha corrections.\n\n  if (!alpha) resetAlpha(dest, destW, destH);\n  return dest;\n};\n\n},{\"./convolve\":2,\"./resize_filter_gen\":6}],6:[function(_dereq_,module,exports){\n\nvar FILTER_INFO = _dereq_('./resize_filter_info'); // Precision of fixed FP values\n\n\nvar FIXED_FRAC_BITS = 14;\n\nfunction toFixedPoint(num) {\n  return Math.round(num * ((1 << FIXED_FRAC_BITS) - 1));\n}\n\nmodule.exports = function resizeFilterGen(quality, srcSize, destSize, scale, offset) {\n  var filterFunction = FILTER_INFO[quality].filter;\n  var scaleInverted = 1.0 / scale;\n  var scaleClamped = Math.min(1.0, scale); // For upscale\n  // Filter window (averaging interval), scaled to src image\n\n  var srcWindow = FILTER_INFO[quality].win / scaleClamped;\n  var destPixel, srcPixel, srcFirst, srcLast, filterElementSize, floatFilter, fxpFilter, total, pxl, idx, floatVal, filterTotal, filterVal;\n  var leftNotEmpty, rightNotEmpty, filterShift, filterSize;\n  var maxFilterElementSize = Math.floor((srcWindow + 1) * 2);\n  var packedFilter = new Int16Array((maxFilterElementSize + 2) * destSize);\n  var packedFilterPtr = 0;\n  var slowCopy = !packedFilter.subarray || !packedFilter.set; // For each destination pixel calculate source range and built filter values\n\n  for (destPixel = 0; destPixel < destSize; destPixel++) {\n    // Scaling should be done relative to central pixel point\n    srcPixel = (destPixel + 0.5) * scaleInverted + offset;\n    srcFirst = Math.max(0, Math.floor(srcPixel - srcWindow));\n    srcLast = Math.min(srcSize - 1, Math.ceil(srcPixel + srcWindow));\n    filterElementSize = srcLast - srcFirst + 1;\n    floatFilter = new Float32Array(filterElementSize);\n    fxpFilter = new Int16Array(filterElementSize);\n    total = 0.0; // Fill filter values for calculated range\n\n    for (pxl = srcFirst, idx = 0; pxl <= srcLast; pxl++, idx++) {\n      floatVal = filterFunction((pxl + 0.5 - srcPixel) * scaleClamped);\n      total += floatVal;\n      floatFilter[idx] = floatVal;\n    } // Normalize filter, convert to fixed point and accumulate conversion error\n\n\n    filterTotal = 0;\n\n    for (idx = 0; idx < floatFilter.length; idx++) {\n      filterVal = floatFilter[idx] / total;\n      filterTotal += filterVal;\n      fxpFilter[idx] = toFixedPoint(filterVal);\n    } // Compensate normalization error, to minimize brightness drift\n\n\n    fxpFilter[destSize >> 1] += toFixedPoint(1.0 - filterTotal); //\n    // Now pack filter to useable form\n    //\n    // 1. Trim heading and tailing zero values, and compensate shitf/length\n    // 2. Put all to single array in this format:\n    //\n    //    [ pos shift, data length, value1, value2, value3, ... ]\n    //\n\n    leftNotEmpty = 0;\n\n    while (leftNotEmpty < fxpFilter.length && fxpFilter[leftNotEmpty] === 0) {\n      leftNotEmpty++;\n    }\n\n    if (leftNotEmpty < fxpFilter.length) {\n      rightNotEmpty = fxpFilter.length - 1;\n\n      while (rightNotEmpty > 0 && fxpFilter[rightNotEmpty] === 0) {\n        rightNotEmpty--;\n      }\n\n      filterShift = srcFirst + leftNotEmpty;\n      filterSize = rightNotEmpty - leftNotEmpty + 1;\n      packedFilter[packedFilterPtr++] = filterShift; // shift\n\n      packedFilter[packedFilterPtr++] = filterSize; // size\n\n      if (!slowCopy) {\n        packedFilter.set(fxpFilter.subarray(leftNotEmpty, rightNotEmpty + 1), packedFilterPtr);\n        packedFilterPtr += filterSize;\n      } else {\n        // fallback for old IE < 11, without subarray/set methods\n        for (idx = leftNotEmpty; idx <= rightNotEmpty; idx++) {\n          packedFilter[packedFilterPtr++] = fxpFilter[idx];\n        }\n      }\n    } else {\n      // zero data, write header only\n      packedFilter[packedFilterPtr++] = 0; // shift\n\n      packedFilter[packedFilterPtr++] = 0; // size\n    }\n  }\n\n  return packedFilter;\n};\n\n},{\"./resize_filter_info\":7}],7:[function(_dereq_,module,exports){\n\nmodule.exports = [{\n  // Nearest neibor (Box)\n  win: 0.5,\n  filter: function filter(x) {\n    return x >= -0.5 && x < 0.5 ? 1.0 : 0.0;\n  }\n}, {\n  // Hamming\n  win: 1.0,\n  filter: function filter(x) {\n    if (x <= -1.0 || x >= 1.0) {\n      return 0.0;\n    }\n\n    if (x > -1.19209290E-07 && x < 1.19209290E-07) {\n      return 1.0;\n    }\n\n    var xpi = x * Math.PI;\n    return Math.sin(xpi) / xpi * (0.54 + 0.46 * Math.cos(xpi / 1.0));\n  }\n}, {\n  // Lanczos, win = 2\n  win: 2.0,\n  filter: function filter(x) {\n    if (x <= -2.0 || x >= 2.0) {\n      return 0.0;\n    }\n\n    if (x > -1.19209290E-07 && x < 1.19209290E-07) {\n      return 1.0;\n    }\n\n    var xpi = x * Math.PI;\n    return Math.sin(xpi) / xpi * Math.sin(xpi / 2.0) / (xpi / 2.0);\n  }\n}, {\n  // Lanczos, win = 3\n  win: 3.0,\n  filter: function filter(x) {\n    if (x <= -3.0 || x >= 3.0) {\n      return 0.0;\n    }\n\n    if (x > -1.19209290E-07 && x < 1.19209290E-07) {\n      return 1.0;\n    }\n\n    var xpi = x * Math.PI;\n    return Math.sin(xpi) / xpi * Math.sin(xpi / 3.0) / (xpi / 3.0);\n  }\n}];\n\n},{}],8:[function(_dereq_,module,exports){\n\nvar createFilters = _dereq_('./resize_filter_gen');\n\nfunction resetAlpha(dst, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    dst[ptr] = 0xFF;\n    ptr = ptr + 4 | 0;\n  }\n}\n\nfunction asUint8Array(src) {\n  return new Uint8Array(src.buffer, 0, src.byteLength);\n}\n\nvar IS_LE = true; // should not crash everything on module load in old browsers\n\ntry {\n  IS_LE = new Uint32Array(new Uint8Array([1, 0, 0, 0]).buffer)[0] === 1;\n} catch (__) {}\n\nfunction copyInt16asLE(src, target, target_offset) {\n  if (IS_LE) {\n    target.set(asUint8Array(src), target_offset);\n    return;\n  }\n\n  for (var ptr = target_offset, i = 0; i < src.length; i++) {\n    var data = src[i];\n    target[ptr++] = data & 0xFF;\n    target[ptr++] = data >> 8 & 0xFF;\n  }\n}\n\nmodule.exports = function resize_wasm(options) {\n  var src = options.src;\n  var srcW = options.width;\n  var srcH = options.height;\n  var destW = options.toWidth;\n  var destH = options.toHeight;\n  var scaleX = options.scaleX || options.toWidth / options.width;\n  var scaleY = options.scaleY || options.toHeight / options.height;\n  var offsetX = options.offsetX || 0.0;\n  var offsetY = options.offsetY || 0.0;\n  var dest = options.dest || new Uint8Array(destW * destH * 4);\n  var quality = typeof options.quality === 'undefined' ? 3 : options.quality;\n  var alpha = options.alpha || false;\n  var filtersX = createFilters(quality, srcW, destW, scaleX, offsetX),\n      filtersY = createFilters(quality, srcH, destH, scaleY, offsetY); // destination is 0 too.\n\n  var src_offset = 0; // buffer between convolve passes\n\n  var tmp_offset = this.__align(src_offset + Math.max(src.byteLength, dest.byteLength));\n\n  var filtersX_offset = this.__align(tmp_offset + srcH * destW * 4);\n\n  var filtersY_offset = this.__align(filtersX_offset + filtersX.byteLength);\n\n  var alloc_bytes = filtersY_offset + filtersY.byteLength;\n\n  var instance = this.__instance('resize', alloc_bytes); //\n  // Fill memory block with data to process\n  //\n\n\n  var mem = new Uint8Array(this.__memory.buffer);\n  var mem32 = new Uint32Array(this.__memory.buffer); // 32-bit copy is much faster in chrome\n\n  var src32 = new Uint32Array(src.buffer);\n  mem32.set(src32); // We should guarantee LE bytes order. Filters are not big, so\n  // speed difference is not significant vs direct .set()\n\n  copyInt16asLE(filtersX, mem, filtersX_offset);\n  copyInt16asLE(filtersY, mem, filtersY_offset); //\n  // Now call webassembly method\n  // emsdk does method names with '_'\n\n  var fn = instance.exports.convolveHV || instance.exports._convolveHV;\n  fn(filtersX_offset, filtersY_offset, tmp_offset, srcW, srcH, destW, destH); //\n  // Copy data back to typed array\n  //\n  // 32-bit copy is much faster in chrome\n\n  var dest32 = new Uint32Array(dest.buffer);\n  dest32.set(new Uint32Array(this.__memory.buffer, 0, destH * destW)); // That's faster than doing checks in convolver.\n  // !!! Note, canvas data is not premultipled. We don't need other\n  // alpha corrections.\n\n  if (!alpha) resetAlpha(dest, destW, destH);\n  return dest;\n};\n\n},{\"./resize_filter_gen\":6}],9:[function(_dereq_,module,exports){\n\nmodule.exports = {\n  name: 'unsharp_mask',\n  fn: _dereq_('./unsharp_mask'),\n  wasm_fn: _dereq_('./unsharp_mask_wasm'),\n  wasm_src: _dereq_('./unsharp_mask_wasm_base64')\n};\n\n},{\"./unsharp_mask\":10,\"./unsharp_mask_wasm\":11,\"./unsharp_mask_wasm_base64\":12}],10:[function(_dereq_,module,exports){\n\nvar glur_mono16 = _dereq_('glur/mono16');\n\nfunction hsv_v16(img, width, height) {\n  var size = width * height;\n  var out = new Uint16Array(size);\n  var r, g, b, max;\n\n  for (var i = 0; i < size; i++) {\n    r = img[4 * i];\n    g = img[4 * i + 1];\n    b = img[4 * i + 2];\n    max = r >= g && r >= b ? r : g >= b && g >= r ? g : b;\n    out[i] = max << 8;\n  }\n\n  return out;\n}\n\nmodule.exports = function unsharp(img, width, height, amount, radius, threshold) {\n  var v1, v2, vmul;\n  var diff, iTimes4;\n\n  if (amount === 0 || radius < 0.5) {\n    return;\n  }\n\n  if (radius > 2.0) {\n    radius = 2.0;\n  }\n\n  var brightness = hsv_v16(img, width, height);\n  var blured = new Uint16Array(brightness); // copy, because blur modify src\n\n  glur_mono16(blured, width, height, radius);\n  var amountFp = amount / 100 * 0x1000 + 0.5 | 0;\n  var thresholdFp = threshold << 8;\n  var size = width * height;\n  /* eslint-disable indent */\n\n  for (var i = 0; i < size; i++) {\n    v1 = brightness[i];\n    diff = v1 - blured[i];\n\n    if (Math.abs(diff) >= thresholdFp) {\n      // add unsharp mask to the brightness channel\n      v2 = v1 + (amountFp * diff + 0x800 >> 12); // Both v1 and v2 are within [0.0 .. 255.0] (0000-FF00) range, never going into\n      // [255.003 .. 255.996] (FF01-FFFF). This allows to round this value as (x+.5)|0\n      // later without overflowing.\n\n      v2 = v2 > 0xff00 ? 0xff00 : v2;\n      v2 = v2 < 0x0000 ? 0x0000 : v2; // Avoid division by 0. V=0 means rgb(0,0,0), unsharp with unsharpAmount>0 cannot\n      // change this value (because diff between colors gets inflated), so no need to verify correctness.\n\n      v1 = v1 !== 0 ? v1 : 1; // Multiplying V in HSV model by a constant is equivalent to multiplying each component\n      // in RGB by the same constant (same for HSL), see also:\n      // https://beesbuzz.biz/code/16-hsv-color-transforms\n\n      vmul = (v2 << 12) / v1 | 0; // Result will be in [0..255] range because:\n      //  - all numbers are positive\n      //  - r,g,b <= (v1/256)\n      //  - r,g,b,(v1/256),(v2/256) <= 255\n      // So highest this number can get is X*255/X+0.5=255.5 which is < 256 and rounds down.\n\n      iTimes4 = i * 4;\n      img[iTimes4] = img[iTimes4] * vmul + 0x800 >> 12; // R\n\n      img[iTimes4 + 1] = img[iTimes4 + 1] * vmul + 0x800 >> 12; // G\n\n      img[iTimes4 + 2] = img[iTimes4 + 2] * vmul + 0x800 >> 12; // B\n    }\n  }\n};\n\n},{\"glur/mono16\":18}],11:[function(_dereq_,module,exports){\n\nmodule.exports = function unsharp(img, width, height, amount, radius, threshold) {\n  if (amount === 0 || radius < 0.5) {\n    return;\n  }\n\n  if (radius > 2.0) {\n    radius = 2.0;\n  }\n\n  var pixels = width * height;\n  var img_bytes_cnt = pixels * 4;\n  var hsv_bytes_cnt = pixels * 2;\n  var blur_bytes_cnt = pixels * 2;\n  var blur_line_byte_cnt = Math.max(width, height) * 4; // float32 array\n\n  var blur_coeffs_byte_cnt = 8 * 4; // float32 array\n\n  var img_offset = 0;\n  var hsv_offset = img_bytes_cnt;\n  var blur_offset = hsv_offset + hsv_bytes_cnt;\n  var blur_tmp_offset = blur_offset + blur_bytes_cnt;\n  var blur_line_offset = blur_tmp_offset + blur_bytes_cnt;\n  var blur_coeffs_offset = blur_line_offset + blur_line_byte_cnt;\n\n  var instance = this.__instance('unsharp_mask', img_bytes_cnt + hsv_bytes_cnt + blur_bytes_cnt * 2 + blur_line_byte_cnt + blur_coeffs_byte_cnt, {\n    exp: Math.exp\n  }); // 32-bit copy is much faster in chrome\n\n\n  var img32 = new Uint32Array(img.buffer);\n  var mem32 = new Uint32Array(this.__memory.buffer);\n  mem32.set(img32); // HSL\n\n  var fn = instance.exports.hsv_v16 || instance.exports._hsv_v16;\n  fn(img_offset, hsv_offset, width, height); // BLUR\n\n  fn = instance.exports.blurMono16 || instance.exports._blurMono16;\n  fn(hsv_offset, blur_offset, blur_tmp_offset, blur_line_offset, blur_coeffs_offset, width, height, radius); // UNSHARP\n\n  fn = instance.exports.unsharp || instance.exports._unsharp;\n  fn(img_offset, img_offset, hsv_offset, blur_offset, width, height, amount, threshold); // 32-bit copy is much faster in chrome\n\n  img32.set(new Uint32Array(this.__memory.buffer, 0, pixels));\n};\n\n},{}],12:[function(_dereq_,module,exports){\n/* eslint-disable max-len */\n\nmodule.exports = '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';\n\n},{}],13:[function(_dereq_,module,exports){\n\nvar GC_INTERVAL = 100;\n\nfunction Pool(create, idle) {\n  this.create = create;\n  this.available = [];\n  this.acquired = {};\n  this.lastId = 1;\n  this.timeoutId = 0;\n  this.idle = idle || 2000;\n}\n\nPool.prototype.acquire = function () {\n  var _this = this;\n\n  var resource;\n\n  if (this.available.length !== 0) {\n    resource = this.available.pop();\n  } else {\n    resource = this.create();\n    resource.id = this.lastId++;\n\n    resource.release = function () {\n      return _this.release(resource);\n    };\n  }\n\n  this.acquired[resource.id] = resource;\n  return resource;\n};\n\nPool.prototype.release = function (resource) {\n  var _this2 = this;\n\n  delete this.acquired[resource.id];\n  resource.lastUsed = Date.now();\n  this.available.push(resource);\n\n  if (this.timeoutId === 0) {\n    this.timeoutId = setTimeout(function () {\n      return _this2.gc();\n    }, GC_INTERVAL);\n  }\n};\n\nPool.prototype.gc = function () {\n  var _this3 = this;\n\n  var now = Date.now();\n  this.available = this.available.filter(function (resource) {\n    if (now - resource.lastUsed > _this3.idle) {\n      resource.destroy();\n      return false;\n    }\n\n    return true;\n  });\n\n  if (this.available.length !== 0) {\n    this.timeoutId = setTimeout(function () {\n      return _this3.gc();\n    }, GC_INTERVAL);\n  } else {\n    this.timeoutId = 0;\n  }\n};\n\nmodule.exports = Pool;\n\n},{}],14:[function(_dereq_,module,exports){\n// min size = 1 can consume large amount of memory\n\nvar MIN_INNER_TILE_SIZE = 2;\n\nmodule.exports = function createStages(fromWidth, fromHeight, toWidth, toHeight, srcTileSize, destTileBorder) {\n  var scaleX = toWidth / fromWidth;\n  var scaleY = toHeight / fromHeight; // derived from createRegions equation:\n  // innerTileWidth = pixelFloor(srcTileSize * scaleX) - 2 * destTileBorder;\n\n  var minScale = (2 * destTileBorder + MIN_INNER_TILE_SIZE + 1) / srcTileSize; // refuse to scale image multiple times by less than twice each time,\n  // it could only happen because of invalid options\n\n  if (minScale > 0.5) return [[toWidth, toHeight]];\n  var stageCount = Math.ceil(Math.log(Math.min(scaleX, scaleY)) / Math.log(minScale)); // no additional resizes are necessary,\n  // stageCount can be zero or be negative when enlarging the image\n\n  if (stageCount <= 1) return [[toWidth, toHeight]];\n  var result = [];\n\n  for (var i = 0; i < stageCount; i++) {\n    var width = Math.round(Math.pow(Math.pow(fromWidth, stageCount - i - 1) * Math.pow(toWidth, i + 1), 1 / stageCount));\n    var height = Math.round(Math.pow(Math.pow(fromHeight, stageCount - i - 1) * Math.pow(toHeight, i + 1), 1 / stageCount));\n    result.push([width, height]);\n  }\n\n  return result;\n};\n\n},{}],15:[function(_dereq_,module,exports){\n/*\n * pixelFloor and pixelCeil are modified versions of Math.floor and Math.ceil\n * functions which take into account floating point arithmetic errors.\n * Those errors can cause undesired increments/decrements of sizes and offsets:\n * Math.ceil(36 / (36 / 500)) = 501\n * pixelCeil(36 / (36 / 500)) = 500\n */\n\nvar PIXEL_EPSILON = 1e-5;\n\nfunction pixelFloor(x) {\n  var nearest = Math.round(x);\n\n  if (Math.abs(x - nearest) < PIXEL_EPSILON) {\n    return nearest;\n  }\n\n  return Math.floor(x);\n}\n\nfunction pixelCeil(x) {\n  var nearest = Math.round(x);\n\n  if (Math.abs(x - nearest) < PIXEL_EPSILON) {\n    return nearest;\n  }\n\n  return Math.ceil(x);\n}\n\nmodule.exports = function createRegions(options) {\n  var scaleX = options.toWidth / options.width;\n  var scaleY = options.toHeight / options.height;\n  var innerTileWidth = pixelFloor(options.srcTileSize * scaleX) - 2 * options.destTileBorder;\n  var innerTileHeight = pixelFloor(options.srcTileSize * scaleY) - 2 * options.destTileBorder; // prevent infinite loop, this should never happen\n\n  if (innerTileWidth < 1 || innerTileHeight < 1) {\n    throw new Error('Internal error in pica: target tile width/height is too small.');\n  }\n\n  var x, y;\n  var innerX, innerY, toTileWidth, toTileHeight;\n  var tiles = [];\n  var tile; // we go top-to-down instead of left-to-right to make image displayed from top to\n  // doesn in the browser\n\n  for (innerY = 0; innerY < options.toHeight; innerY += innerTileHeight) {\n    for (innerX = 0; innerX < options.toWidth; innerX += innerTileWidth) {\n      x = innerX - options.destTileBorder;\n\n      if (x < 0) {\n        x = 0;\n      }\n\n      toTileWidth = innerX + innerTileWidth + options.destTileBorder - x;\n\n      if (x + toTileWidth >= options.toWidth) {\n        toTileWidth = options.toWidth - x;\n      }\n\n      y = innerY - options.destTileBorder;\n\n      if (y < 0) {\n        y = 0;\n      }\n\n      toTileHeight = innerY + innerTileHeight + options.destTileBorder - y;\n\n      if (y + toTileHeight >= options.toHeight) {\n        toTileHeight = options.toHeight - y;\n      }\n\n      tile = {\n        toX: x,\n        toY: y,\n        toWidth: toTileWidth,\n        toHeight: toTileHeight,\n        toInnerX: innerX,\n        toInnerY: innerY,\n        toInnerWidth: innerTileWidth,\n        toInnerHeight: innerTileHeight,\n        offsetX: x / scaleX - pixelFloor(x / scaleX),\n        offsetY: y / scaleY - pixelFloor(y / scaleY),\n        scaleX: scaleX,\n        scaleY: scaleY,\n        x: pixelFloor(x / scaleX),\n        y: pixelFloor(y / scaleY),\n        width: pixelCeil(toTileWidth / scaleX),\n        height: pixelCeil(toTileHeight / scaleY)\n      };\n      tiles.push(tile);\n    }\n  }\n\n  return tiles;\n};\n\n},{}],16:[function(_dereq_,module,exports){\n\nfunction objClass(obj) {\n  return Object.prototype.toString.call(obj);\n}\n\nmodule.exports.isCanvas = function isCanvas(element) {\n  var cname = objClass(element);\n  return cname === '[object HTMLCanvasElement]'\n  /* browser */\n  || cname === '[object OffscreenCanvas]' || cname === '[object Canvas]'\n  /* node-canvas */\n  ;\n};\n\nmodule.exports.isImage = function isImage(element) {\n  return objClass(element) === '[object HTMLImageElement]';\n};\n\nmodule.exports.isImageBitmap = function isImageBitmap(element) {\n  return objClass(element) === '[object ImageBitmap]';\n};\n\nmodule.exports.limiter = function limiter(concurrency) {\n  var active = 0,\n      queue = [];\n\n  function roll() {\n    if (active < concurrency && queue.length) {\n      active++;\n      queue.shift()();\n    }\n  }\n\n  return function limit(fn) {\n    return new Promise(function (resolve, reject) {\n      queue.push(function () {\n        fn().then(function (result) {\n          resolve(result);\n          active--;\n          roll();\n        }, function (err) {\n          reject(err);\n          active--;\n          roll();\n        });\n      });\n      roll();\n    });\n  };\n};\n\nmodule.exports.cib_quality_name = function cib_quality_name(num) {\n  switch (num) {\n    case 0:\n      return 'pixelated';\n\n    case 1:\n      return 'low';\n\n    case 2:\n      return 'medium';\n  }\n\n  return 'high';\n};\n\nmodule.exports.cib_support = function cib_support(createCanvas) {\n  return Promise.resolve().then(function () {\n    if (typeof createImageBitmap === 'undefined') {\n      return false;\n    }\n\n    var c = createCanvas(100, 100);\n    return createImageBitmap(c, 0, 0, 100, 100, {\n      resizeWidth: 10,\n      resizeHeight: 10,\n      resizeQuality: 'high'\n    }).then(function (bitmap) {\n      var status = bitmap.width === 10; // Branch below is filtered on upper level. We do not call resize\n      // detection for basic ImageBitmap.\n      //\n      // https://developer.mozilla.org/en-US/docs/Web/API/ImageBitmap\n      // old Crome 51 has ImageBitmap without .close(). Then this code\n      // will throw and return 'false' as expected.\n      //\n\n      bitmap.close();\n      c = null;\n      return status;\n    });\n  })[\"catch\"](function () {\n    return false;\n  });\n};\n\nmodule.exports.worker_offscreen_canvas_support = function worker_offscreen_canvas_support() {\n  return new Promise(function (resolve, reject) {\n    if (typeof OffscreenCanvas === 'undefined') {\n      // if OffscreenCanvas is present, we assume browser supports Worker and built-in Promise as well\n      resolve(false);\n      return;\n    }\n\n    function workerPayload(self) {\n      if (typeof createImageBitmap === 'undefined') {\n        self.postMessage(false);\n        return;\n      }\n\n      Promise.resolve().then(function () {\n        var canvas = new OffscreenCanvas(10, 10); // test that 2d context can be used in worker\n\n        var ctx = canvas.getContext('2d');\n        ctx.rect(0, 0, 1, 1); // test that cib can be used to return image bitmap from worker\n\n        return createImageBitmap(canvas, 0, 0, 1, 1);\n      }).then(function () {\n        return self.postMessage(true);\n      }, function () {\n        return self.postMessage(false);\n      });\n    }\n\n    var code = btoa(\"(\".concat(workerPayload.toString(), \")(self);\"));\n    var w = new Worker(\"data:text/javascript;base64,\".concat(code));\n\n    w.onmessage = function (ev) {\n      return resolve(ev.data);\n    };\n\n    w.onerror = reject;\n  }).then(function (result) {\n    return result;\n  }, function () {\n    return false;\n  });\n}; // Check if canvas.getContext('2d').getImageData can be used,\n// FireFox randomizes the output of that function in `privacy.resistFingerprinting` mode\n\n\nmodule.exports.can_use_canvas = function can_use_canvas(createCanvas) {\n  var usable = false;\n\n  try {\n    var canvas = createCanvas(2, 1);\n    var ctx = canvas.getContext('2d');\n    var d = ctx.createImageData(2, 1);\n    d.data[0] = 12;\n    d.data[1] = 23;\n    d.data[2] = 34;\n    d.data[3] = 255;\n    d.data[4] = 45;\n    d.data[5] = 56;\n    d.data[6] = 67;\n    d.data[7] = 255;\n    ctx.putImageData(d, 0, 0);\n    d = null;\n    d = ctx.getImageData(0, 0, 2, 1);\n\n    if (d.data[0] === 12 && d.data[1] === 23 && d.data[2] === 34 && d.data[3] === 255 && d.data[4] === 45 && d.data[5] === 56 && d.data[6] === 67 && d.data[7] === 255) {\n      usable = true;\n    }\n  } catch (err) {}\n\n  return usable;\n}; // Check if createImageBitmap(img, sx, sy, sw, sh) signature works correctly\n// with JPEG images oriented with Exif;\n// https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n// TODO: remove after it's fixed in chrome for at least 2 releases\n\n\nmodule.exports.cib_can_use_region = function cib_can_use_region() {\n  return new Promise(function (resolve) {\n    if (typeof createImageBitmap === 'undefined') {\n      resolve(false);\n      return;\n    }\n\n    var image = new Image();\n    image.src = 'data:image/jpeg;base64,' + '/9j/4QBiRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAYAAAEaAAUAAAABAAAASgEbAAUAA' + 'AABAAAAUgEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAAAAABIAAAAAQAAAEgAAAAB/9' + 'sAQwAEAwMEAwMEBAMEBQQEBQYKBwYGBgYNCQoICg8NEBAPDQ8OERMYFBESFxIODxUcFRc' + 'ZGRsbGxAUHR8dGh8YGhsa/9sAQwEEBQUGBQYMBwcMGhEPERoaGhoaGhoaGhoaGhoaGhoa' + 'GhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoa/8IAEQgAAQACAwERAAIRAQMRA' + 'f/EABQAAQAAAAAAAAAAAAAAAAAAAAf/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAA' + 'IQAxAAAAF/P//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAQUCf//EABQRAQAAAAA' + 'AAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIB' + 'AT8Bf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEABj8Cf//EABQQAQAAAAAAAAAAA' + 'AAAAAAAAAD/2gAIAQEAAT8hf//aAAwDAQACAAMAAAAQH//EABQRAQAAAAAAAAAAAAAAAA' + 'AAAAD/2gAIAQMBAT8Qf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Qf//EABQ' + 'QAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8Qf//Z';\n\n    image.onload = function () {\n      createImageBitmap(image, 0, 0, image.width, image.height).then(function (bitmap) {\n        if (bitmap.width === image.width && bitmap.height === image.height) {\n          resolve(true);\n        } else {\n          resolve(false);\n        }\n      }, function () {\n        return resolve(false);\n      });\n    };\n\n    image.onerror = function () {\n      return resolve(false);\n    };\n  });\n};\n\n},{}],17:[function(_dereq_,module,exports){\n\nmodule.exports = function () {\n  var MathLib = _dereq_('./mathlib');\n\n  var mathLib;\n  /* eslint-disable no-undef */\n\n  onmessage = function onmessage(ev) {\n    var tileOpts = ev.data.opts;\n    var returnBitmap = false;\n\n    if (!tileOpts.src && tileOpts.srcBitmap) {\n      var canvas = new OffscreenCanvas(tileOpts.width, tileOpts.height);\n      var ctx = canvas.getContext('2d', {\n        alpha: Boolean(tileOpts.alpha)\n      });\n      ctx.drawImage(tileOpts.srcBitmap, 0, 0);\n      tileOpts.src = ctx.getImageData(0, 0, tileOpts.width, tileOpts.height).data;\n      canvas.width = canvas.height = 0;\n      canvas = null;\n      tileOpts.srcBitmap.close();\n      tileOpts.srcBitmap = null;\n      returnBitmap = true;\n    }\n\n    if (!mathLib) mathLib = new MathLib(ev.data.features); // Use multimath's sync auto-init. Avoid Promise use in old browsers,\n    // because polyfills are not propagated to webworker.\n\n    var data = mathLib.resizeAndUnsharp(tileOpts);\n\n    if (returnBitmap) {\n      var toImageData = new ImageData(new Uint8ClampedArray(data), tileOpts.toWidth, tileOpts.toHeight);\n\n      var _canvas = new OffscreenCanvas(tileOpts.toWidth, tileOpts.toHeight);\n\n      var _ctx = _canvas.getContext('2d', {\n        alpha: Boolean(tileOpts.alpha)\n      });\n\n      _ctx.putImageData(toImageData, 0, 0);\n\n      createImageBitmap(_canvas).then(function (bitmap) {\n        postMessage({\n          bitmap: bitmap\n        }, [bitmap]);\n      });\n    } else {\n      postMessage({\n        data: data\n      }, [data.buffer]);\n    }\n  };\n};\n\n},{\"./mathlib\":1}],18:[function(_dereq_,module,exports){\n// Calculate Gaussian blur of an image using IIR filter\n// The method is taken from Intel's white paper and code example attached to it:\n// https://software.intel.com/en-us/articles/iir-gaussian-blur-filter\n// -implementation-using-intel-advanced-vector-extensions\n\nvar a0, a1, a2, a3, b1, b2, left_corner, right_corner;\n\nfunction gaussCoef(sigma) {\n  if (sigma < 0.5) {\n    sigma = 0.5;\n  }\n\n  var a = Math.exp(0.726 * 0.726) / sigma,\n      g1 = Math.exp(-a),\n      g2 = Math.exp(-2 * a),\n      k = (1 - g1) * (1 - g1) / (1 + 2 * a * g1 - g2);\n\n  a0 = k;\n  a1 = k * (a - 1) * g1;\n  a2 = k * (a + 1) * g1;\n  a3 = -k * g2;\n  b1 = 2 * g1;\n  b2 = -g2;\n  left_corner = (a0 + a1) / (1 - b1 - b2);\n  right_corner = (a2 + a3) / (1 - b1 - b2);\n\n  // Attempt to force type to FP32.\n  return new Float32Array([ a0, a1, a2, a3, b1, b2, left_corner, right_corner ]);\n}\n\nfunction convolveMono16(src, out, line, coeff, width, height) {\n  // takes src image and writes the blurred and transposed result into out\n\n  var prev_src, curr_src, curr_out, prev_out, prev_prev_out;\n  var src_index, out_index, line_index;\n  var i, j;\n  var coeff_a0, coeff_a1, coeff_b1, coeff_b2;\n\n  for (i = 0; i < height; i++) {\n    src_index = i * width;\n    out_index = i;\n    line_index = 0;\n\n    // left to right\n    prev_src = src[src_index];\n    prev_prev_out = prev_src * coeff[6];\n    prev_out = prev_prev_out;\n\n    coeff_a0 = coeff[0];\n    coeff_a1 = coeff[1];\n    coeff_b1 = coeff[4];\n    coeff_b2 = coeff[5];\n\n    for (j = 0; j < width; j++) {\n      curr_src = src[src_index];\n\n      curr_out = curr_src * coeff_a0 +\n                 prev_src * coeff_a1 +\n                 prev_out * coeff_b1 +\n                 prev_prev_out * coeff_b2;\n\n      prev_prev_out = prev_out;\n      prev_out = curr_out;\n      prev_src = curr_src;\n\n      line[line_index] = prev_out;\n      line_index++;\n      src_index++;\n    }\n\n    src_index--;\n    line_index--;\n    out_index += height * (width - 1);\n\n    // right to left\n    prev_src = src[src_index];\n    prev_prev_out = prev_src * coeff[7];\n    prev_out = prev_prev_out;\n    curr_src = prev_src;\n\n    coeff_a0 = coeff[2];\n    coeff_a1 = coeff[3];\n\n    for (j = width - 1; j >= 0; j--) {\n      curr_out = curr_src * coeff_a0 +\n                 prev_src * coeff_a1 +\n                 prev_out * coeff_b1 +\n                 prev_prev_out * coeff_b2;\n\n      prev_prev_out = prev_out;\n      prev_out = curr_out;\n\n      prev_src = curr_src;\n      curr_src = src[src_index];\n\n      out[out_index] = line[line_index] + prev_out;\n\n      src_index--;\n      line_index--;\n      out_index -= height;\n    }\n  }\n}\n\n\nfunction blurMono16(src, width, height, radius) {\n  // Quick exit on zero radius\n  if (!radius) { return; }\n\n  var out      = new Uint16Array(src.length),\n      tmp_line = new Float32Array(Math.max(width, height));\n\n  var coeff = gaussCoef(radius);\n\n  convolveMono16(src, out, tmp_line, coeff, width, height);\n  convolveMono16(out, src, tmp_line, coeff, height, width);\n}\n\nmodule.exports = blurMono16;\n\n},{}],19:[function(_dereq_,module,exports){\nif (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor;\n      ctor.prototype = Object.create(superCtor.prototype, {\n        constructor: {\n          value: ctor,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      });\n    }\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor;\n      var TempCtor = function () {};\n      TempCtor.prototype = superCtor.prototype;\n      ctor.prototype = new TempCtor();\n      ctor.prototype.constructor = ctor;\n    }\n  };\n}\n\n},{}],20:[function(_dereq_,module,exports){\n\n\nvar assign         = _dereq_('object-assign');\nvar base64decode   = _dereq_('./lib/base64decode');\nvar hasWebAssembly = _dereq_('./lib/wa_detect');\n\n\nvar DEFAULT_OPTIONS = {\n  js: true,\n  wasm: true\n};\n\n\nfunction MultiMath(options) {\n  if (!(this instanceof MultiMath)) return new MultiMath(options);\n\n  var opts = assign({}, DEFAULT_OPTIONS, options || {});\n\n  this.options         = opts;\n\n  this.__cache         = {};\n\n  this.__init_promise  = null;\n  this.__modules       = opts.modules || {};\n  this.__memory        = null;\n  this.__wasm          = {};\n\n  this.__isLE = ((new Uint32Array((new Uint8Array([ 1, 0, 0, 0 ])).buffer))[0] === 1);\n\n  if (!this.options.js && !this.options.wasm) {\n    throw new Error('mathlib: at least \"js\" or \"wasm\" should be enabled');\n  }\n}\n\n\nMultiMath.prototype.has_wasm = hasWebAssembly;\n\n\nMultiMath.prototype.use = function (module) {\n  this.__modules[module.name] = module;\n\n  // Pin the best possible implementation\n  if (this.options.wasm && this.has_wasm() && module.wasm_fn) {\n    this[module.name] = module.wasm_fn;\n  } else {\n    this[module.name] = module.fn;\n  }\n\n  return this;\n};\n\n\nMultiMath.prototype.init = function () {\n  if (this.__init_promise) return this.__init_promise;\n\n  if (!this.options.js && this.options.wasm && !this.has_wasm()) {\n    return Promise.reject(new Error('mathlib: only \"wasm\" was enabled, but it\\'s not supported'));\n  }\n\n  var self = this;\n\n  this.__init_promise = Promise.all(Object.keys(self.__modules).map(function (name) {\n    var module = self.__modules[name];\n\n    if (!self.options.wasm || !self.has_wasm() || !module.wasm_fn) return null;\n\n    // If already compiled - exit\n    if (self.__wasm[name]) return null;\n\n    // Compile wasm source\n    return WebAssembly.compile(self.__base64decode(module.wasm_src))\n      .then(function (m) { self.__wasm[name] = m; });\n  }))\n    .then(function () { return self; });\n\n  return this.__init_promise;\n};\n\n\n////////////////////////////////////////////////////////////////////////////////\n// Methods below are for internal use from plugins\n\n\n// Simple decode base64 to typed array. Useful to load embedded webassembly\n// code. You probably don't need to call this method directly.\n//\nMultiMath.prototype.__base64decode = base64decode;\n\n\n// Increase current memory to include specified number of bytes. Do nothing if\n// size is already ok. You probably don't need to call this method directly,\n// because it will be invoked from `.__instance()`.\n//\nMultiMath.prototype.__reallocate = function mem_grow_to(bytes) {\n  if (!this.__memory) {\n    this.__memory = new WebAssembly.Memory({\n      initial: Math.ceil(bytes / (64 * 1024))\n    });\n    return this.__memory;\n  }\n\n  var mem_size = this.__memory.buffer.byteLength;\n\n  if (mem_size < bytes) {\n    this.__memory.grow(Math.ceil((bytes - mem_size) / (64 * 1024)));\n  }\n\n  return this.__memory;\n};\n\n\n// Returns instantinated webassembly item by name, with specified memory size\n// and environment.\n// - use cache if available\n// - do sync module init, if async init was not called earlier\n// - allocate memory if not enougth\n// - can export functions to webassembly via \"env_extra\",\n//   for example, { exp: Math.exp }\n//\nMultiMath.prototype.__instance = function instance(name, memsize, env_extra) {\n  if (memsize) this.__reallocate(memsize);\n\n  // If .init() was not called, do sync compile\n  if (!this.__wasm[name]) {\n    var module = this.__modules[name];\n    this.__wasm[name] = new WebAssembly.Module(this.__base64decode(module.wasm_src));\n  }\n\n  if (!this.__cache[name]) {\n    var env_base = {\n      memoryBase: 0,\n      memory: this.__memory,\n      tableBase: 0,\n      table: new WebAssembly.Table({ initial: 0, element: 'anyfunc' })\n    };\n\n    this.__cache[name] = new WebAssembly.Instance(this.__wasm[name], {\n      env: assign(env_base, env_extra || {})\n    });\n  }\n\n  return this.__cache[name];\n};\n\n\n// Helper to calculate memory aligh for pointers. Webassembly does not require\n// this, but you may wish to experiment. Default base = 8;\n//\nMultiMath.prototype.__align = function align(number, base) {\n  base = base || 8;\n  var reminder = number % base;\n  return number + (reminder ? base - reminder : 0);\n};\n\n\nmodule.exports = MultiMath;\n\n},{\"./lib/base64decode\":21,\"./lib/wa_detect\":22,\"object-assign\":23}],21:[function(_dereq_,module,exports){\n\n\nvar BASE64_MAP = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\n\nmodule.exports = function base64decode(str) {\n  var input = str.replace(/[\\r\\n=]/g, ''), // remove CR/LF & padding to simplify scan\n      max   = input.length;\n\n  var out = new Uint8Array((max * 3) >> 2);\n\n  // Collect by 6*4 bits (3 bytes)\n\n  var bits = 0;\n  var ptr  = 0;\n\n  for (var idx = 0; idx < max; idx++) {\n    if ((idx % 4 === 0) && idx) {\n      out[ptr++] = (bits >> 16) & 0xFF;\n      out[ptr++] = (bits >> 8) & 0xFF;\n      out[ptr++] = bits & 0xFF;\n    }\n\n    bits = (bits << 6) | BASE64_MAP.indexOf(input.charAt(idx));\n  }\n\n  // Dump tail\n\n  var tailbits = (max % 4) * 6;\n\n  if (tailbits === 0) {\n    out[ptr++] = (bits >> 16) & 0xFF;\n    out[ptr++] = (bits >> 8) & 0xFF;\n    out[ptr++] = bits & 0xFF;\n  } else if (tailbits === 18) {\n    out[ptr++] = (bits >> 10) & 0xFF;\n    out[ptr++] = (bits >> 2) & 0xFF;\n  } else if (tailbits === 12) {\n    out[ptr++] = (bits >> 4) & 0xFF;\n  }\n\n  return out;\n};\n\n},{}],22:[function(_dereq_,module,exports){\n\n\nvar wa;\n\n\nmodule.exports = function hasWebAssembly() {\n  // use cache if called before;\n  if (typeof wa !== 'undefined') return wa;\n\n  wa = false;\n\n  if (typeof WebAssembly === 'undefined') return wa;\n\n  // If WebAssenbly is disabled, code can throw on compile\n  try {\n    // https://github.com/brion/min-wasm-fail/blob/master/min-wasm-fail.in.js\n    // Additional check that WA internals are correct\n\n    /* eslint-disable comma-spacing, max-len */\n    var bin      = new Uint8Array([ 0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11 ]);\n    var module   = new WebAssembly.Module(bin);\n    var instance = new WebAssembly.Instance(module, {});\n\n    // test storing to and loading from a non-zero location via a parameter.\n    // Safari on iOS 11.2.5 returns 0 unexpectedly at non-zero locations\n    if (instance.exports.test(4) !== 0) wa = true;\n\n    return wa;\n  } catch (__) {}\n\n  return wa;\n};\n\n},{}],23:[function(_dereq_,module,exports){\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n\n},{}],24:[function(_dereq_,module,exports){\nvar bundleFn = arguments[3];\nvar sources = arguments[4];\nvar cache = arguments[5];\n\nvar stringify = JSON.stringify;\n\nmodule.exports = function (fn, options) {\n    var wkey;\n    var cacheKeys = Object.keys(cache);\n\n    for (var i = 0, l = cacheKeys.length; i < l; i++) {\n        var key = cacheKeys[i];\n        var exp = cache[key].exports;\n        // Using babel as a transpiler to use esmodule, the export will always\n        // be an object with the default export as a property of it. To ensure\n        // the existing api and babel esmodule exports are both supported we\n        // check for both\n        if (exp === fn || exp && exp.default === fn) {\n            wkey = key;\n            break;\n        }\n    }\n\n    if (!wkey) {\n        wkey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n        var wcache = {};\n        for (var i = 0, l = cacheKeys.length; i < l; i++) {\n            var key = cacheKeys[i];\n            wcache[key] = key;\n        }\n        sources[wkey] = [\n            'function(require,module,exports){' + fn + '(self); }',\n            wcache\n        ];\n    }\n    var skey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n\n    var scache = {}; scache[wkey] = wkey;\n    sources[skey] = [\n        'function(require,module,exports){' +\n            // try to call default if defined to also support babel esmodule exports\n            'var f = require(' + stringify(wkey) + ');' +\n            '(f.default ? f.default : f)(self);' +\n        '}',\n        scache\n    ];\n\n    var workerSources = {};\n    resolveSources(skey);\n\n    function resolveSources(key) {\n        workerSources[key] = true;\n\n        for (var depPath in sources[key][1]) {\n            var depKey = sources[key][1][depPath];\n            if (!workerSources[depKey]) {\n                resolveSources(depKey);\n            }\n        }\n    }\n\n    var src = '(' + bundleFn + ')({'\n        + Object.keys(workerSources).map(function (key) {\n            return stringify(key) + ':['\n                + sources[key][0]\n                + ',' + stringify(sources[key][1]) + ']'\n            ;\n        }).join(',')\n        + '},{},[' + stringify(skey) + '])'\n    ;\n\n    var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n    var blob = new Blob([src], { type: 'text/javascript' });\n    if (options && options.bare) { return blob; }\n    var workerUrl = URL.createObjectURL(blob);\n    var worker = new Worker(workerUrl);\n    worker.objectURL = workerUrl;\n    return worker;\n};\n\n},{}],\"/index.js\":[function(_dereq_,module,exports){\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nvar assign = _dereq_('object-assign');\n\nvar webworkify = _dereq_('webworkify');\n\nvar MathLib = _dereq_('./lib/mathlib');\n\nvar Pool = _dereq_('./lib/pool');\n\nvar utils = _dereq_('./lib/utils');\n\nvar worker = _dereq_('./lib/worker');\n\nvar createStages = _dereq_('./lib/stepper');\n\nvar createRegions = _dereq_('./lib/tiler'); // Deduplicate pools & limiters with the same configs\n// when user creates multiple pica instances.\n\n\nvar singletones = {};\nvar NEED_SAFARI_FIX = false;\n\ntry {\n  if (typeof navigator !== 'undefined' && navigator.userAgent) {\n    NEED_SAFARI_FIX = navigator.userAgent.indexOf('Safari') >= 0;\n  }\n} catch (e) {}\n\nvar concurrency = 1;\n\nif (typeof navigator !== 'undefined') {\n  concurrency = Math.min(navigator.hardwareConcurrency || 1, 4);\n}\n\nvar DEFAULT_PICA_OPTS = {\n  tile: 1024,\n  concurrency: concurrency,\n  features: ['js', 'wasm', 'ww'],\n  idle: 2000,\n  createCanvas: function createCanvas(width, height) {\n    var tmpCanvas = document.createElement('canvas');\n    tmpCanvas.width = width;\n    tmpCanvas.height = height;\n    return tmpCanvas;\n  }\n};\nvar DEFAULT_RESIZE_OPTS = {\n  quality: 3,\n  alpha: false,\n  unsharpAmount: 0,\n  unsharpRadius: 0.0,\n  unsharpThreshold: 0\n};\nvar CAN_NEW_IMAGE_DATA = false;\nvar CAN_CREATE_IMAGE_BITMAP = false;\nvar CAN_USE_CANVAS_GET_IMAGE_DATA = false;\nvar CAN_USE_OFFSCREEN_CANVAS = false;\nvar CAN_USE_CIB_REGION_FOR_IMAGE = false;\n\nfunction workerFabric() {\n  return {\n    value: webworkify(worker),\n    destroy: function destroy() {\n      this.value.terminate();\n\n      if (typeof window !== 'undefined') {\n        var url = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n        if (url && url.revokeObjectURL && this.value.objectURL) {\n          url.revokeObjectURL(this.value.objectURL);\n        }\n      }\n    }\n  };\n} ////////////////////////////////////////////////////////////////////////////////\n// API methods\n\n\nfunction Pica(options) {\n  if (!(this instanceof Pica)) return new Pica(options);\n  this.options = assign({}, DEFAULT_PICA_OPTS, options || {});\n  var limiter_key = \"lk_\".concat(this.options.concurrency); // Share limiters to avoid multiple parallel workers when user creates\n  // multiple pica instances.\n\n  this.__limit = singletones[limiter_key] || utils.limiter(this.options.concurrency);\n  if (!singletones[limiter_key]) singletones[limiter_key] = this.__limit; // List of supported features, according to options & browser/node.js\n\n  this.features = {\n    js: false,\n    // pure JS implementation, can be disabled for testing\n    wasm: false,\n    // webassembly implementation for heavy functions\n    cib: false,\n    // resize via createImageBitmap (only FF at this moment)\n    ww: false // webworkers\n\n  };\n  this.__workersPool = null; // Store requested features for webworkers\n\n  this.__requested_features = [];\n  this.__mathlib = null;\n}\n\nPica.prototype.init = function () {\n  var _this = this;\n\n  if (this.__initPromise) return this.__initPromise; // Test if we can create ImageData without canvas and memory copy\n\n  if (typeof ImageData !== 'undefined' && typeof Uint8ClampedArray !== 'undefined') {\n    try {\n      /* eslint-disable no-new */\n      new ImageData(new Uint8ClampedArray(400), 10, 10);\n      CAN_NEW_IMAGE_DATA = true;\n    } catch (__) {}\n  } // ImageBitmap can be effective in 2 places:\n  //\n  // 1. Threaded jpeg unpack (basic)\n  // 2. Built-in resize (blocked due problem in chrome, see issue #89)\n  //\n  // For basic use we also need ImageBitmap wo support .close() method,\n  // see https://developer.mozilla.org/ru/docs/Web/API/ImageBitmap\n\n\n  if (typeof ImageBitmap !== 'undefined') {\n    if (ImageBitmap.prototype && ImageBitmap.prototype.close) {\n      CAN_CREATE_IMAGE_BITMAP = true;\n    } else {\n      this.debug('ImageBitmap does not support .close(), disabled');\n    }\n  }\n\n  var features = this.options.features.slice();\n\n  if (features.indexOf('all') >= 0) {\n    features = ['cib', 'wasm', 'js', 'ww'];\n  }\n\n  this.__requested_features = features;\n  this.__mathlib = new MathLib(features); // Check WebWorker support if requested\n\n  if (features.indexOf('ww') >= 0) {\n    if (typeof window !== 'undefined' && 'Worker' in window) {\n      // IE <= 11 don't allow to create webworkers from string. We should check it.\n      // https://connect.microsoft.com/IE/feedback/details/801810/web-workers-from-blob-urls-in-ie-10-and-11\n      try {\n        var wkr = _dereq_('webworkify')(function () {});\n\n        wkr.terminate();\n        this.features.ww = true; // pool uniqueness depends on pool config + webworker config\n\n        var wpool_key = \"wp_\".concat(JSON.stringify(this.options));\n\n        if (singletones[wpool_key]) {\n          this.__workersPool = singletones[wpool_key];\n        } else {\n          this.__workersPool = new Pool(workerFabric, this.options.idle);\n          singletones[wpool_key] = this.__workersPool;\n        }\n      } catch (__) {}\n    }\n  }\n\n  var initMath = this.__mathlib.init().then(function (mathlib) {\n    // Copy detected features\n    assign(_this.features, mathlib.features);\n  });\n\n  var checkCibResize;\n\n  if (!CAN_CREATE_IMAGE_BITMAP) {\n    checkCibResize = Promise.resolve(false);\n  } else {\n    checkCibResize = utils.cib_support(this.options.createCanvas).then(function (status) {\n      if (_this.features.cib && features.indexOf('cib') < 0) {\n        _this.debug('createImageBitmap() resize supported, but disabled by config');\n\n        return;\n      }\n\n      if (features.indexOf('cib') >= 0) _this.features.cib = status;\n    });\n  }\n\n  CAN_USE_CANVAS_GET_IMAGE_DATA = utils.can_use_canvas(this.options.createCanvas);\n  var checkOffscreenCanvas;\n\n  if (CAN_CREATE_IMAGE_BITMAP && CAN_NEW_IMAGE_DATA && features.indexOf('ww') !== -1) {\n    checkOffscreenCanvas = utils.worker_offscreen_canvas_support();\n  } else {\n    checkOffscreenCanvas = Promise.resolve(false);\n  }\n\n  checkOffscreenCanvas = checkOffscreenCanvas.then(function (result) {\n    CAN_USE_OFFSCREEN_CANVAS = result;\n  }); // we use createImageBitmap to crop image data and pass it to workers,\n  // so need to check whether function works correctly;\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n\n  var checkCibRegion = utils.cib_can_use_region().then(function (result) {\n    CAN_USE_CIB_REGION_FOR_IMAGE = result;\n  }); // Init math lib. That's async because can load some\n\n  this.__initPromise = Promise.all([initMath, checkCibResize, checkOffscreenCanvas, checkCibRegion]).then(function () {\n    return _this;\n  });\n  return this.__initPromise;\n}; // Call resizer in webworker or locally, depending on config\n\n\nPica.prototype.__invokeResize = function (tileOpts, opts) {\n  var _this2 = this;\n\n  // Share cache between calls:\n  //\n  // - wasm instance\n  // - wasm memory object\n  //\n  opts.__mathCache = opts.__mathCache || {};\n  return Promise.resolve().then(function () {\n    if (!_this2.features.ww) {\n      // not possible to have ImageBitmap here if user disabled WW\n      return {\n        data: _this2.__mathlib.resizeAndUnsharp(tileOpts, opts.__mathCache)\n      };\n    }\n\n    return new Promise(function (resolve, reject) {\n      var w = _this2.__workersPool.acquire();\n\n      if (opts.cancelToken) opts.cancelToken[\"catch\"](function (err) {\n        return reject(err);\n      });\n\n      w.value.onmessage = function (ev) {\n        w.release();\n        if (ev.data.err) reject(ev.data.err);else resolve(ev.data);\n      };\n\n      var transfer = [];\n      if (tileOpts.src) transfer.push(tileOpts.src.buffer);\n      if (tileOpts.srcBitmap) transfer.push(tileOpts.srcBitmap);\n      w.value.postMessage({\n        opts: tileOpts,\n        features: _this2.__requested_features,\n        preload: {\n          wasm_nodule: _this2.__mathlib.__\n        }\n      }, transfer);\n    });\n  });\n}; // this function can return promise if createImageBitmap is used\n\n\nPica.prototype.__extractTileData = function (tile, from, opts, stageEnv, extractTo) {\n  if (this.features.ww && CAN_USE_OFFSCREEN_CANVAS && ( // createImageBitmap doesn't work for images (Image, ImageBitmap) with Exif orientation in Chrome,\n  // can use canvas because canvas doesn't have orientation;\n  // see https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n  utils.isCanvas(from) || CAN_USE_CIB_REGION_FOR_IMAGE)) {\n    this.debug('Create tile for OffscreenCanvas');\n    return createImageBitmap(stageEnv.srcImageBitmap || from, tile.x, tile.y, tile.width, tile.height).then(function (bitmap) {\n      extractTo.srcBitmap = bitmap;\n      return extractTo;\n    });\n  } // Extract tile RGBA buffer, depending on input type\n\n\n  if (utils.isCanvas(from)) {\n    if (!stageEnv.srcCtx) stageEnv.srcCtx = from.getContext('2d', {\n      alpha: Boolean(opts.alpha)\n    }); // If input is Canvas - extract region data directly\n\n    this.debug('Get tile pixel data');\n    extractTo.src = stageEnv.srcCtx.getImageData(tile.x, tile.y, tile.width, tile.height).data;\n    return extractTo;\n  } // If input is Image or decoded to ImageBitmap,\n  // draw region to temporary canvas and extract data from it\n  //\n  // Note! Attempt to reuse this canvas causes significant slowdown in chrome\n  //\n\n\n  this.debug('Draw tile imageBitmap/image to temporary canvas');\n  var tmpCanvas = this.options.createCanvas(tile.width, tile.height);\n  var tmpCtx = tmpCanvas.getContext('2d', {\n    alpha: Boolean(opts.alpha)\n  });\n  tmpCtx.globalCompositeOperation = 'copy';\n  tmpCtx.drawImage(stageEnv.srcImageBitmap || from, tile.x, tile.y, tile.width, tile.height, 0, 0, tile.width, tile.height);\n  this.debug('Get tile pixel data');\n  extractTo.src = tmpCtx.getImageData(0, 0, tile.width, tile.height).data; // Safari 12 workaround\n  // https://github.com/nodeca/pica/issues/199\n\n  tmpCanvas.width = tmpCanvas.height = 0;\n  return extractTo;\n};\n\nPica.prototype.__landTileData = function (tile, result, stageEnv) {\n  var toImageData;\n  this.debug('Convert raw rgba tile result to ImageData');\n\n  if (result.bitmap) {\n    stageEnv.toCtx.drawImage(result.bitmap, tile.toX, tile.toY);\n    return null;\n  }\n\n  if (CAN_NEW_IMAGE_DATA) {\n    // this branch is for modern browsers\n    // If `new ImageData()` & Uint8ClampedArray suported\n    toImageData = new ImageData(new Uint8ClampedArray(result.data), tile.toWidth, tile.toHeight);\n  } else {\n    // fallback for `node-canvas` and old browsers\n    // (IE11 has ImageData but does not support `new ImageData()`)\n    toImageData = stageEnv.toCtx.createImageData(tile.toWidth, tile.toHeight);\n\n    if (toImageData.data.set) {\n      toImageData.data.set(result.data);\n    } else {\n      // IE9 don't have `.set()`\n      for (var i = toImageData.data.length - 1; i >= 0; i--) {\n        toImageData.data[i] = result.data[i];\n      }\n    }\n  }\n\n  this.debug('Draw tile');\n\n  if (NEED_SAFARI_FIX) {\n    // Safari draws thin white stripes between tiles without this fix\n    stageEnv.toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth + 1e-5, tile.toInnerHeight + 1e-5);\n  } else {\n    stageEnv.toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth, tile.toInnerHeight);\n  }\n\n  return null;\n};\n\nPica.prototype.__tileAndResize = function (from, to, opts) {\n  var _this3 = this;\n\n  var stageEnv = {\n    srcCtx: null,\n    srcImageBitmap: null,\n    isImageBitmapReused: false,\n    toCtx: null\n  };\n\n  var processTile = function processTile(tile) {\n    return _this3.__limit(function () {\n      if (opts.canceled) return opts.cancelToken;\n      var tileOpts = {\n        width: tile.width,\n        height: tile.height,\n        toWidth: tile.toWidth,\n        toHeight: tile.toHeight,\n        scaleX: tile.scaleX,\n        scaleY: tile.scaleY,\n        offsetX: tile.offsetX,\n        offsetY: tile.offsetY,\n        quality: opts.quality,\n        alpha: opts.alpha,\n        unsharpAmount: opts.unsharpAmount,\n        unsharpRadius: opts.unsharpRadius,\n        unsharpThreshold: opts.unsharpThreshold\n      };\n\n      _this3.debug('Invoke resize math');\n\n      return Promise.resolve(tileOpts).then(function (tileOpts) {\n        return _this3.__extractTileData(tile, from, opts, stageEnv, tileOpts);\n      }).then(function (tileOpts) {\n        _this3.debug('Invoke resize math');\n\n        return _this3.__invokeResize(tileOpts, opts);\n      }).then(function (result) {\n        if (opts.canceled) return opts.cancelToken;\n        stageEnv.srcImageData = null;\n        return _this3.__landTileData(tile, result, stageEnv);\n      });\n    });\n  }; // Need to normalize data source first. It can be canvas or image.\n  // If image - try to decode in background if possible\n\n\n  return Promise.resolve().then(function () {\n    stageEnv.toCtx = to.getContext('2d', {\n      alpha: Boolean(opts.alpha)\n    });\n    if (utils.isCanvas(from)) return null;\n\n    if (utils.isImageBitmap(from)) {\n      stageEnv.srcImageBitmap = from;\n      stageEnv.isImageBitmapReused = true;\n      return null;\n    }\n\n    if (utils.isImage(from)) {\n      // try do decode image in background for faster next operations;\n      // if we're using offscreen canvas, cib is called per tile, so not needed here\n      if (!CAN_CREATE_IMAGE_BITMAP) return null;\n\n      _this3.debug('Decode image via createImageBitmap');\n\n      return createImageBitmap(from).then(function (imageBitmap) {\n        stageEnv.srcImageBitmap = imageBitmap;\n      }) // Suppress error to use fallback, if method fails\n      // https://github.com/nodeca/pica/issues/190\n\n      /* eslint-disable no-unused-vars */\n      [\"catch\"](function (e) {\n        return null;\n      });\n    }\n\n    throw new Error('Pica: \".from\" should be Image, Canvas or ImageBitmap');\n  }).then(function () {\n    if (opts.canceled) return opts.cancelToken;\n\n    _this3.debug('Calculate tiles'); //\n    // Here we are with \"normalized\" source,\n    // follow to tiling\n    //\n\n\n    var regions = createRegions({\n      width: opts.width,\n      height: opts.height,\n      srcTileSize: _this3.options.tile,\n      toWidth: opts.toWidth,\n      toHeight: opts.toHeight,\n      destTileBorder: opts.__destTileBorder\n    });\n    var jobs = regions.map(function (tile) {\n      return processTile(tile);\n    });\n\n    function cleanup(stageEnv) {\n      if (stageEnv.srcImageBitmap) {\n        if (!stageEnv.isImageBitmapReused) stageEnv.srcImageBitmap.close();\n        stageEnv.srcImageBitmap = null;\n      }\n    }\n\n    _this3.debug('Process tiles');\n\n    return Promise.all(jobs).then(function () {\n      _this3.debug('Finished!');\n\n      cleanup(stageEnv);\n      return to;\n    }, function (err) {\n      cleanup(stageEnv);\n      throw err;\n    });\n  });\n};\n\nPica.prototype.__processStages = function (stages, from, to, opts) {\n  var _this4 = this;\n\n  if (opts.canceled) return opts.cancelToken;\n\n  var _stages$shift = stages.shift(),\n      _stages$shift2 = _slicedToArray(_stages$shift, 2),\n      toWidth = _stages$shift2[0],\n      toHeight = _stages$shift2[1];\n\n  var isLastStage = stages.length === 0;\n  opts = assign({}, opts, {\n    toWidth: toWidth,\n    toHeight: toHeight,\n    // only use user-defined quality for the last stage,\n    // use simpler (Hamming) filter for the first stages where\n    // scale factor is large enough (more than 2-3)\n    quality: isLastStage ? opts.quality : Math.min(1, opts.quality)\n  });\n  var tmpCanvas;\n\n  if (!isLastStage) {\n    // create temporary canvas\n    tmpCanvas = this.options.createCanvas(toWidth, toHeight);\n  }\n\n  return this.__tileAndResize(from, isLastStage ? to : tmpCanvas, opts).then(function () {\n    if (isLastStage) return to;\n    opts.width = toWidth;\n    opts.height = toHeight;\n    return _this4.__processStages(stages, tmpCanvas, to, opts);\n  }).then(function (res) {\n    if (tmpCanvas) {\n      // Safari 12 workaround\n      // https://github.com/nodeca/pica/issues/199\n      tmpCanvas.width = tmpCanvas.height = 0;\n    }\n\n    return res;\n  });\n};\n\nPica.prototype.__resizeViaCreateImageBitmap = function (from, to, opts) {\n  var _this5 = this;\n\n  var toCtx = to.getContext('2d', {\n    alpha: Boolean(opts.alpha)\n  });\n  this.debug('Resize via createImageBitmap()');\n  return createImageBitmap(from, {\n    resizeWidth: opts.toWidth,\n    resizeHeight: opts.toHeight,\n    resizeQuality: utils.cib_quality_name(opts.quality)\n  }).then(function (imageBitmap) {\n    if (opts.canceled) return opts.cancelToken; // if no unsharp - draw directly to output canvas\n\n    if (!opts.unsharpAmount) {\n      toCtx.drawImage(imageBitmap, 0, 0);\n      imageBitmap.close();\n      toCtx = null;\n\n      _this5.debug('Finished!');\n\n      return to;\n    }\n\n    _this5.debug('Unsharp result');\n\n    var tmpCanvas = _this5.options.createCanvas(opts.toWidth, opts.toHeight);\n\n    var tmpCtx = tmpCanvas.getContext('2d', {\n      alpha: Boolean(opts.alpha)\n    });\n    tmpCtx.drawImage(imageBitmap, 0, 0);\n    imageBitmap.close();\n    var iData = tmpCtx.getImageData(0, 0, opts.toWidth, opts.toHeight);\n\n    _this5.__mathlib.unsharp_mask(iData.data, opts.toWidth, opts.toHeight, opts.unsharpAmount, opts.unsharpRadius, opts.unsharpThreshold);\n\n    toCtx.putImageData(iData, 0, 0); // Safari 12 workaround\n    // https://github.com/nodeca/pica/issues/199\n\n    tmpCanvas.width = tmpCanvas.height = 0;\n    iData = tmpCtx = tmpCanvas = toCtx = null;\n\n    _this5.debug('Finished!');\n\n    return to;\n  });\n};\n\nPica.prototype.resize = function (from, to, options) {\n  var _this6 = this;\n\n  this.debug('Start resize...');\n  var opts = assign({}, DEFAULT_RESIZE_OPTS);\n\n  if (!isNaN(options)) {\n    opts = assign(opts, {\n      quality: options\n    });\n  } else if (options) {\n    opts = assign(opts, options);\n  }\n\n  opts.toWidth = to.width;\n  opts.toHeight = to.height;\n  opts.width = from.naturalWidth || from.width;\n  opts.height = from.naturalHeight || from.height; // Prevent stepper from infinite loop\n\n  if (to.width === 0 || to.height === 0) {\n    return Promise.reject(new Error(\"Invalid output size: \".concat(to.width, \"x\").concat(to.height)));\n  }\n\n  if (opts.unsharpRadius > 2) opts.unsharpRadius = 2;\n  opts.canceled = false;\n\n  if (opts.cancelToken) {\n    // Wrap cancelToken to avoid successive resolve & set flag\n    opts.cancelToken = opts.cancelToken.then(function (data) {\n      opts.canceled = true;\n      throw data;\n    }, function (err) {\n      opts.canceled = true;\n      throw err;\n    });\n  }\n\n  var DEST_TILE_BORDER = 3; // Max possible filter window size\n\n  opts.__destTileBorder = Math.ceil(Math.max(DEST_TILE_BORDER, 2.5 * opts.unsharpRadius | 0));\n  return this.init().then(function () {\n    if (opts.canceled) return opts.cancelToken; // if createImageBitmap supports resize, just do it and return\n\n    if (_this6.features.cib) {\n      return _this6.__resizeViaCreateImageBitmap(from, to, opts);\n    }\n\n    if (!CAN_USE_CANVAS_GET_IMAGE_DATA) {\n      var err = new Error('Pica: cannot use getImageData on canvas, ' + \"make sure fingerprinting protection isn't enabled\");\n      err.code = 'ERR_GET_IMAGE_DATA';\n      throw err;\n    } //\n    // No easy way, let's resize manually via arrays\n    //\n\n\n    var stages = createStages(opts.width, opts.height, opts.toWidth, opts.toHeight, _this6.options.tile, opts.__destTileBorder);\n    return _this6.__processStages(stages, from, to, opts);\n  });\n}; // RGBA buffer resize\n//\n\n\nPica.prototype.resizeBuffer = function (options) {\n  var _this7 = this;\n\n  var opts = assign({}, DEFAULT_RESIZE_OPTS, options);\n  return this.init().then(function () {\n    return _this7.__mathlib.resizeAndUnsharp(opts);\n  });\n};\n\nPica.prototype.toBlob = function (canvas, mimeType, quality) {\n  mimeType = mimeType || 'image/png';\n  return new Promise(function (resolve) {\n    if (canvas.toBlob) {\n      canvas.toBlob(function (blob) {\n        return resolve(blob);\n      }, mimeType, quality);\n      return;\n    }\n\n    if (canvas.convertToBlob) {\n      resolve(canvas.convertToBlob({\n        type: mimeType,\n        quality: quality\n      }));\n      return;\n    } // Fallback for old browsers\n\n\n    var asString = atob(canvas.toDataURL(mimeType, quality).split(',')[1]);\n    var len = asString.length;\n    var asBuffer = new Uint8Array(len);\n\n    for (var i = 0; i < len; i++) {\n      asBuffer[i] = asString.charCodeAt(i);\n    }\n\n    resolve(new Blob([asBuffer], {\n      type: mimeType\n    }));\n  });\n};\n\nPica.prototype.debug = function () {};\n\nmodule.exports = Pica;\n\n},{\"./lib/mathlib\":1,\"./lib/pool\":13,\"./lib/stepper\":14,\"./lib/tiler\":15,\"./lib/utils\":16,\"./lib/worker\":17,\"object-assign\":23,\"webworkify\":24}]},{},[])(\"/index.js\")\n});\n});\n\nvar image_traverse = createCommonjsModule(function (module) {\n\n//////////////////////////////////////////////////////////////////////////\n// Helpers\n//\nfunction error(message, code) {\n  var err = new Error(message);\n  err.code = code;\n  return err;\n}\n\n\n// Convert number to 0xHH string\n//\nfunction to_hex(number) {\n  var n = number.toString(16).toUpperCase();\n  for (var i = 2 - n.length; i > 0; i--) n = '0' + n;\n  return '0x' + n;\n}\n\n\nfunction utf8_encode(str) {\n  try {\n    return unescape(encodeURIComponent(str));\n  } catch (_) {\n    return str;\n  }\n}\n\n\nfunction utf8_decode(str) {\n  try {\n    return decodeURIComponent(escape(str));\n  } catch (_) {\n    return str;\n  }\n}\n\n\n// Check if input is a Uint8Array\n//\nfunction is_uint8array(bin) {\n  return Object.prototype.toString.call(bin) === '[object Uint8Array]';\n}\n\n\n//////////////////////////////////////////////////////////////////////////\n// Exif parser\n//\n// Input:\n//  - jpeg_bin:   Uint8Array - jpeg file\n//  - exif_start: Number     - start of TIFF header (after Exif\\0\\0)\n//  - exif_end:   Number     - end of Exif segment\n//  - on_entry:   Number     - callback\n//\nfunction ExifParser(jpeg_bin, exif_start, exif_end) {\n  // Uint8Array, exif without signature (which isn't included in offsets)\n  this.input      = jpeg_bin.subarray(exif_start, exif_end);\n\n  // offset correction for `on_entry` callback\n  this.start      = exif_start;\n\n  // Check TIFF header (includes byte alignment and first IFD offset)\n  var sig = String.fromCharCode.apply(null, this.input.subarray(0, 4));\n\n  if (sig !== 'II\\x2A\\0' && sig !== 'MM\\0\\x2A') {\n    throw error('invalid TIFF signature', 'EBADDATA');\n  }\n\n  // true if motorola (big endian) byte alignment, false if intel\n  this.big_endian = sig[0] === 'M';\n}\n\n\nExifParser.prototype.each = function (on_entry) {\n  // allow premature exit\n  this.aborted = false;\n\n  var offset = this.read_uint32(4);\n\n  this.ifds_to_read = [ {\n    id:     0,\n    offset: offset\n  } ];\n\n  while (this.ifds_to_read.length > 0 && !this.aborted) {\n    var i = this.ifds_to_read.shift();\n    if (!i.offset) continue;\n    this.scan_ifd(i.id, i.offset, on_entry);\n  }\n};\n\n\nExifParser.prototype.filter = function (on_entry) {\n  var ifds = {};\n\n  // make sure IFD0 always exists\n  ifds.ifd0 = { id: 0, entries: [] };\n\n  this.each(function (entry) {\n    if (on_entry(entry) === false && !entry.is_subifd_link) return;\n    if (entry.is_subifd_link && entry.count !== 1 && entry.format !== 4) return; // filter out bogus links\n\n    if (!ifds['ifd' + entry.ifd]) {\n      ifds['ifd' + entry.ifd] = { id: entry.ifd, entries: [] };\n    }\n\n    ifds['ifd' + entry.ifd].entries.push(entry);\n  });\n\n  // thumbnails are not supported just yet, so delete all information related to it\n  delete ifds.ifd1;\n\n  // Calculate output size\n  var length = 8;\n  Object.keys(ifds).forEach(function (ifd_no) {\n    length += 2;\n\n    ifds[ifd_no].entries.forEach(function (entry) {\n      length += 12 + (entry.data_length > 4 ? Math.ceil(entry.data_length / 2) * 2 : 0);\n    });\n\n    length += 4;\n  });\n\n  this.output = new Uint8Array(length);\n  this.output[0] = this.output[1] = (this.big_endian ? 'M' : 'I').charCodeAt(0);\n  this.write_uint16(2, 0x2A);\n\n  var offset = 8;\n  var self = this;\n  this.write_uint32(4, offset);\n\n  Object.keys(ifds).forEach(function (ifd_no) {\n    ifds[ifd_no].written_offset = offset;\n\n    var ifd_start = offset;\n    var ifd_end   = ifd_start + 2 + ifds[ifd_no].entries.length * 12 + 4;\n    offset = ifd_end;\n\n    self.write_uint16(ifd_start, ifds[ifd_no].entries.length);\n\n    ifds[ifd_no].entries.sort(function (a, b) {\n      // IFD entries must be in order of increasing tag IDs\n      return a.tag - b.tag;\n    }).forEach(function (entry, idx) {\n      var entry_offset = ifd_start + 2 + idx * 12;\n\n      self.write_uint16(entry_offset, entry.tag);\n      self.write_uint16(entry_offset + 2, entry.format);\n      self.write_uint32(entry_offset + 4, entry.count);\n\n      if (entry.is_subifd_link) {\n        // filled in later\n        if (ifds['ifd' + entry.tag]) ifds['ifd' + entry.tag].link_offset = entry_offset + 8;\n      } else if (entry.data_length <= 4) {\n        self.output.set(\n          self.input.subarray(entry.data_offset - self.start, entry.data_offset - self.start + 4),\n          entry_offset + 8\n        );\n      } else {\n        self.write_uint32(entry_offset + 8, offset);\n        self.output.set(\n          self.input.subarray(entry.data_offset - self.start, entry.data_offset - self.start + entry.data_length),\n          offset\n        );\n        offset += Math.ceil(entry.data_length / 2) * 2;\n      }\n    });\n\n    var next_ifd = ifds['ifd' + (ifds[ifd_no].id + 1)];\n    if (next_ifd) next_ifd.link_offset = ifd_end - 4;\n  });\n\n  Object.keys(ifds).forEach(function (ifd_no) {\n    if (ifds[ifd_no].written_offset && ifds[ifd_no].link_offset) {\n      self.write_uint32(ifds[ifd_no].link_offset, ifds[ifd_no].written_offset);\n    }\n  });\n\n  if (this.output.length !== offset) throw error('internal error: incorrect buffer size allocated');\n\n  return this.output;\n};\n\n\nExifParser.prototype.read_uint16 = function (offset) {\n  var d = this.input;\n  if (offset + 2 > d.length) throw error('unexpected EOF', 'EBADDATA');\n\n  return this.big_endian ?\n    d[offset] * 0x100 + d[offset + 1] :\n    d[offset] + d[offset + 1] * 0x100;\n};\n\n\nExifParser.prototype.read_uint32 = function (offset) {\n  var d = this.input;\n  if (offset + 4 > d.length) throw error('unexpected EOF', 'EBADDATA');\n\n  return this.big_endian ?\n    d[offset] * 0x1000000 + d[offset + 1] * 0x10000 + d[offset + 2] * 0x100 + d[offset + 3] :\n    d[offset] + d[offset + 1] * 0x100 + d[offset + 2] * 0x10000 + d[offset + 3] * 0x1000000;\n};\n\n\nExifParser.prototype.write_uint16 = function (offset, value) {\n  var d = this.output;\n\n  if (this.big_endian) {\n    d[offset]     = (value >>> 8) & 0xFF;\n    d[offset + 1] = value & 0xFF;\n  } else {\n    d[offset]     = value & 0xFF;\n    d[offset + 1] = (value >>> 8) & 0xFF;\n  }\n};\n\n\nExifParser.prototype.write_uint32 = function (offset, value) {\n  var d = this.output;\n\n  if (this.big_endian) {\n    d[offset]     = (value >>> 24) & 0xFF;\n    d[offset + 1] = (value >>> 16) & 0xFF;\n    d[offset + 2] = (value >>> 8) & 0xFF;\n    d[offset + 3] = value & 0xFF;\n  } else {\n    d[offset]     = value & 0xFF;\n    d[offset + 1] = (value >>> 8) & 0xFF;\n    d[offset + 2] = (value >>> 16) & 0xFF;\n    d[offset + 3] = (value >>> 24) & 0xFF;\n  }\n};\n\n\nExifParser.prototype.is_subifd_link = function (ifd, tag) {\n  return (ifd === 0 && tag === 0x8769) || // SubIFD\n         (ifd === 0 && tag === 0x8825) || // GPS Info\n         (ifd === 0x8769 && tag === 0xA005); // Interop IFD\n};\n\n\n// Returns byte length of a single component of a given format\n//\nExifParser.prototype.exif_format_length = function (format) {\n  switch (format) {\n    case 1: // byte\n    case 2: // ascii\n    case 6: // sbyte\n    case 7: // undefined\n      return 1;\n\n    case 3: // short\n    case 8: // sshort\n      return 2;\n\n    case 4:  // long\n    case 9:  // slong\n    case 11: // float\n      return 4;\n\n    case 5:  // rational\n    case 10: // srational\n    case 12: // double\n      return 8;\n\n    default:\n      // unknown type\n      return 0;\n  }\n};\n\n\n// Reads Exif data\n//\nExifParser.prototype.exif_format_read = function (format, offset) {\n  var v;\n\n  switch (format) {\n    case 1: // byte\n    case 2: // ascii\n      v = this.input[offset];\n      return v;\n\n    case 6: // sbyte\n      v = this.input[offset];\n      return v | (v & 0x80) * 0x1fffffe;\n\n    case 3: // short\n      v = this.read_uint16(offset);\n      return v;\n\n    case 8: // sshort\n      v = this.read_uint16(offset);\n      return v | (v & 0x8000) * 0x1fffe;\n\n    case 4: // long\n      v = this.read_uint32(offset);\n      return v;\n\n    case 9: // slong\n      v = this.read_uint32(offset);\n      return v | 0;\n\n    case 5:  // rational\n    case 10: // srational\n    case 11: // float\n    case 12: // double\n      return null; // not implemented\n\n    case 7: // undefined\n      return null; // blob\n\n    default:\n      // unknown type\n      return null;\n  }\n};\n\n\nExifParser.prototype.scan_ifd = function (ifd_no, offset, on_entry) {\n  var entry_count = this.read_uint16(offset);\n\n  offset += 2;\n\n  for (var i = 0; i < entry_count; i++) {\n    var tag    = this.read_uint16(offset);\n    var format = this.read_uint16(offset + 2);\n    var count  = this.read_uint32(offset + 4);\n\n    var comp_length    = this.exif_format_length(format);\n    var data_length    = count * comp_length;\n    var data_offset    = data_length <= 4 ? offset + 8 : this.read_uint32(offset + 8);\n    var is_subifd_link = false;\n\n    if (data_offset + data_length > this.input.length) {\n      throw error('unexpected EOF', 'EBADDATA');\n    }\n\n    var value = [];\n    var comp_offset = data_offset;\n\n    for (var j = 0; j < count; j++, comp_offset += comp_length) {\n      var item = this.exif_format_read(format, comp_offset);\n      if (item === null) {\n        value = null;\n        break;\n      }\n      value.push(item);\n    }\n\n    if (Array.isArray(value) && format === 2) {\n      try {\n        value = utf8_decode(String.fromCharCode.apply(null, value));\n      } catch (_) {\n        value = null;\n      }\n\n      if (value && value[value.length - 1] === '\\0') value = value.slice(0, -1);\n    }\n\n    if (this.is_subifd_link(ifd_no, tag)) {\n      if (Array.isArray(value) && Number.isInteger(value[0]) && value[0] > 0) {\n        this.ifds_to_read.push({\n          id:     tag,\n          offset: value[0]\n        });\n        is_subifd_link = true;\n      }\n    }\n\n    var entry = {\n      is_big_endian:  this.big_endian,\n      ifd:            ifd_no,\n      tag:            tag,\n      format:         format,\n      count:          count,\n      entry_offset:   offset + this.start,\n      data_length:    data_length,\n      data_offset:    data_offset + this.start,\n      value:          value,\n      is_subifd_link: is_subifd_link\n    };\n\n    if (on_entry(entry) === false) {\n      this.aborted = true;\n      return;\n    }\n\n    offset += 12;\n  }\n\n  if (ifd_no === 0) {\n    this.ifds_to_read.push({\n      id:     1,\n      offset: this.read_uint32(offset)\n    });\n  }\n};\n\n\n// Check whether input is a JPEG image\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//\n// Returns true if it is and false otherwise\n//\nmodule.exports.is_jpeg = function (jpeg_bin) {\n  return jpeg_bin.length >= 4 && jpeg_bin[0] === 0xFF && jpeg_bin[1] === 0xD8 && jpeg_bin[2] === 0xFF;\n};\n\n\n// Call an iterator on each segment in the given JPEG image\n//\n// Input:\n//  - jpeg_bin:   Uint8Array - jpeg file\n//  - on_segment: Function - callback executed on each JPEG marker segment\n//    - segment:  Object\n//      - code:   Number - marker type (2nd byte, e.g. 0xE0 for APP0)\n//      - offset: Number - offset of the first byte (0xFF) relative to `jpeg_bin` start\n//      - length: Number - length of the entire marker segment including first two bytes and length\n//        - 2 for standalone markers\n//        - 4+length for markers with data\n//\n// Iteration stops when `EOI` (0xFFD9) marker is reached or if `on_segment`\n// function returns `false`.\n//\nmodule.exports.jpeg_segments_each = function (jpeg_bin, on_segment) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_segment !== 'function') {\n    throw error('Invalid argument (on_segment), Function expected', 'EINVAL');\n  }\n\n  if (!module.exports.is_jpeg(jpeg_bin)) {\n    throw error('Unknown file format', 'ENOTJPEG');\n  }\n\n  var offset = 0, length = jpeg_bin.length, inside_scan = false;\n\n  for (;;) {\n    var segment_code, segment_length;\n\n    if (offset + 1 >= length) throw error('Unexpected EOF', 'EBADDATA');\n    var byte1 = jpeg_bin[offset];\n    var byte2 = jpeg_bin[offset + 1];\n\n    if (byte1 === 0xFF && byte2 === 0xFF) {\n      // padding\n      segment_code = 0xFF;\n      segment_length = 1;\n\n    } else if (byte1 === 0xFF && byte2 !== 0) {\n      // marker\n      segment_code = byte2;\n      segment_length = 2;\n\n      if ((0xD0 <= segment_code && segment_code <= 0xD9) || segment_code === 0x01) ; else {\n        if (offset + 3 >= length) throw error('Unexpected EOF', 'EBADDATA');\n        segment_length += jpeg_bin[offset + 2] * 0x100 + jpeg_bin[offset + 3];\n        if (segment_length < 2) throw error('Invalid segment length', 'EBADDATA');\n        if (offset + segment_length - 1 >= length) throw error('Unexpected EOF', 'EBADDATA');\n      }\n\n      if (inside_scan) {\n        if (segment_code >= 0xD0 && segment_code <= 0xD7) ; else {\n          inside_scan = false;\n        }\n      }\n\n      if (segment_code === 0xDA /* SOS */) inside_scan = true;\n    } else if (inside_scan) {\n      // entropy-encoded segment\n      for (var pos = offset + 1; ; pos++) {\n        // scan until we find FF\n        if (pos >= length) throw error('Unexpected EOF', 'EBADDATA');\n        if (jpeg_bin[pos] === 0xFF) {\n          if (pos + 1 >= length) throw error('Unexpected EOF', 'EBADDATA');\n          if (jpeg_bin[pos + 1] !== 0) {\n            segment_code = 0;\n            segment_length = pos - offset;\n            break;\n          }\n        }\n      }\n    } else {\n      throw error('Unexpected byte at segment start: ' + to_hex(byte1) +\n        ' (offset ' + to_hex(offset) + ')', 'EBADDATA');\n    }\n\n    if (on_segment({ code: segment_code, offset: offset, length: segment_length }) === false) break;\n    if (segment_code === 0xD9 /* EOI */) break;\n    offset += segment_length;\n  }\n};\n\n\n// Replace or remove segments in the given JPEG image\n//\n// Input:\n//  - jpeg_bin:   Uint8Array - jpeg file\n//  - on_segment: Function - callback executed on each JPEG marker segment\n//    - segment:  Object\n//      - code:   Number - marker type (2nd byte, e.g. 0xE0 for APP0)\n//      - offset: Number - offset of the first byte (0xFF) relative to `jpeg_bin` start\n//      - length: Number - length of the entire marker segment including first two bytes and length\n//        - 2 for standalone markers\n//        - 4+length for markers with data\n//\n// `on_segment` function should return one of the following:\n//  - `false`        - segment is removed from the output\n//  - Uint8Array     - segment is replaced with the new data\n//  - [ Uint8Array ] - segment is replaced with the new data\n//  - anything else  - segment is copied to the output as is\n//\n// Any data after `EOI` (0xFFD9) marker is removed.\n//\nmodule.exports.jpeg_segments_filter = function (jpeg_bin, on_segment) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_segment !== 'function') {\n    throw error('Invalid argument (on_segment), Function expected', 'EINVAL');\n  }\n\n  var ranges = [];\n  var out_length = 0;\n\n  module.exports.jpeg_segments_each(jpeg_bin, function (segment) {\n    var new_segment = on_segment(segment);\n\n    if (is_uint8array(new_segment)) {\n      ranges.push({ data: new_segment });\n      out_length += new_segment.length;\n    } else if (Array.isArray(new_segment)) {\n      new_segment.filter(is_uint8array).forEach(function (s) {\n        ranges.push({ data: s });\n        out_length += s.length;\n      });\n    } else if (new_segment !== false) {\n      var new_range = { start: segment.offset, end: segment.offset + segment.length };\n\n      if (ranges.length > 0 && ranges[ranges.length - 1].end === new_range.start) {\n        ranges[ranges.length - 1].end = new_range.end;\n      } else {\n        ranges.push(new_range);\n      }\n\n      out_length += segment.length;\n    }\n  });\n\n  var result = new Uint8Array(out_length);\n  var offset = 0;\n\n  ranges.forEach(function (range) {\n    var data = range.data || jpeg_bin.subarray(range.start, range.end);\n    result.set(data, offset);\n    offset += data.length;\n  });\n\n  return result;\n};\n\n\n// Call an iterator on each Exif entry in the given JPEG image\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//  - on_entry: Function - callback executed on each Exif entry\n//    - entry:  Object\n//      - is_big_endian:  Boolean - whether Exif uses big or little endian byte alignment\n//      - ifd:            Number  - IFD identifier (0 for IFD0, 1 for IFD1, 0x8769 for SubIFD,\n//                                 0x8825 for GPS Info, 0xA005 for Interop IFD)\n//      - tag:            Number  - exif entry tag (0x0110 - camera name, 0x0112 - orientation, etc. - see Exif spec)\n//      - format:         Number  - exif entry format (1 - byte, 2 - ascii, 3 - short, etc. - see Exif spec)\n//      - count:          Number  - number of components of the given format inside data\n//                                 (usually 1, or string length for ascii format)\n//      - entry_offset:   Number  - start of Exif entry (entry length is always 12, so not included)\n//      - data_offset:    Number  - start of data attached to Exif entry (will overlap with entry if length <= 4)\n//      - data_length:    Number  - length of data attached to Exif entry\n//      - value:          Array|String|Null - our best attempt at parsing data (not all formats supported right now)\n//      - is_subifd_link: Boolean - whether this entry is recognized to be a link to subifd (can't filter these out)\n//\n// Iteration stops early if iterator returns `false`.\n//\n// If Exif wasn't found anywhere (before start of the image data, SOS),\n// iterator is never executed.\n//\nmodule.exports.jpeg_exif_tags_each = function (jpeg_bin, on_exif_entry) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_exif_entry !== 'function') {\n    throw error('Invalid argument (on_exif_entry), Function expected', 'EINVAL');\n  }\n\n  /* eslint-disable consistent-return */\n  module.exports.jpeg_segments_each(jpeg_bin, function (segment) {\n    if (segment.code === 0xDA /* SOS */) return false;\n\n    // look for APP1 segment and compare header with 'Exif\\0\\0'\n    if (segment.code === 0xE1 && segment.length >= 10 &&\n        jpeg_bin[segment.offset + 4] === 0x45 && jpeg_bin[segment.offset + 5] === 0x78 &&\n        jpeg_bin[segment.offset + 6] === 0x69 && jpeg_bin[segment.offset + 7] === 0x66 &&\n        jpeg_bin[segment.offset + 8] === 0x00 && jpeg_bin[segment.offset + 9] === 0x00) {\n\n      new ExifParser(jpeg_bin, segment.offset + 10, segment.offset + segment.length).each(on_exif_entry);\n      return false;\n    }\n  });\n};\n\n\n// Remove Exif entries in the given JPEG image\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//  - on_entry: Function - callback executed on each Exif entry\n//    - entry:  Object\n//      - is_big_endian:  Boolean - whether Exif uses big or little endian byte alignment\n//      - ifd:            Number  - IFD identifier (0 for IFD0, 1 for IFD1, 0x8769 for SubIFD,\n//                                  0x8825 for GPS Info, 0xA005 for Interop IFD)\n//      - tag:            Number  - exif entry tag (0x0110 - camera name, 0x0112 - orientation, etc. - see Exif spec)\n//      - format:         Number  - exif entry format (1 - byte, 2 - ascii, 3 - short, etc. - see Exif spec)\n//      - count:          Number  - number of components of the given format inside data\n//                                  (usually 1, or string length for ascii format)\n//      - entry_offset:   Number  - start of Exif entry (entry length is always 12, so not included)\n//      - data_offset:    Number  - start of data attached to Exif entry (will overlap with entry if length <= 4)\n//      - data_length:    Number  - length of data attached to Exif entry\n//      - value:          Array|String|Null - our best attempt at parsing data (not all formats supported right now)\n//      - is_subifd_link: Boolean - whether this entry is recognized to be a link to subifd (can't filter these out)\n//\n// This function removes following from Exif:\n//  - all entries where iterator returned false (except subifd links which are mandatory)\n//  - IFD1 and thumbnail image (the purpose of this function is to reduce file size,\n//    so thumbnail is usually the first thing to go)\n//  - all other data that isn't in IFD0, SubIFD, GPSIFD, InteropIFD\n//    (theoretically possible proprietary extensions, I haven't seen any of these yet)\n//\n// Changing data inside Exif entries is NOT supported yet (modifying `entry` object inside callback may break stuff).\n//\n// If Exif wasn't found anywhere (before start of the image data, SOS),\n// iterator is never executed, and original JPEG is returned as is.\n//\nmodule.exports.jpeg_exif_tags_filter = function (jpeg_bin, on_exif_entry) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_exif_entry !== 'function') {\n    throw error('Invalid argument (on_exif_entry), Function expected', 'EINVAL');\n  }\n\n  var stop_search = false;\n\n  return module.exports.jpeg_segments_filter(jpeg_bin, function (segment) {\n    if (stop_search) return;\n    if (segment.code === 0xDA /* SOS */) stop_search = true;\n\n    // look for APP1 segment and compare header with 'Exif\\0\\0'\n    if (segment.code === 0xE1 && segment.length >= 10 &&\n        jpeg_bin[segment.offset + 4] === 0x45 && jpeg_bin[segment.offset + 5] === 0x78 &&\n        jpeg_bin[segment.offset + 6] === 0x69 && jpeg_bin[segment.offset + 7] === 0x66 &&\n        jpeg_bin[segment.offset + 8] === 0x00 && jpeg_bin[segment.offset + 9] === 0x00) {\n\n      var new_exif = new ExifParser(jpeg_bin, segment.offset + 10, segment.offset + segment.length)\n        .filter(on_exif_entry);\n      if (!new_exif) return false;\n\n      var header = new Uint8Array(10);\n\n      header.set(jpeg_bin.slice(segment.offset, segment.offset + 10));\n      header[2] = ((new_exif.length + 8) >>> 8) & 0xFF;\n      header[3] = (new_exif.length + 8) & 0xFF;\n\n      stop_search = true;\n      return [ header, new_exif ];\n    }\n  });\n};\n\n\n// Inserts a custom comment marker segment into JPEG file.\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//  - comment:  String\n//\n// Comment is inserted after first two bytes (FFD8, SOI).\n//\n// If JFIF (APP0) marker exists immediately after SOI (as mandated by the JFIF\n// spec), we insert comment after it instead.\n//\nmodule.exports.jpeg_add_comment = function (jpeg_bin, comment) {\n  var comment_inserted = false, segment_count = 0;\n\n  return module.exports.jpeg_segments_filter(jpeg_bin, function (segment) {\n    segment_count++;\n    if (segment_count === 1 && segment.code === 0xD8 /* SOI  */) return;\n    if (segment_count === 2 && segment.code === 0xE0 /* APP0 */) return;\n\n    if (comment_inserted) return;\n    comment = utf8_encode(comment);\n\n    // comment segment\n    var csegment = new Uint8Array(5 + comment.length);\n    var offset = 0;\n\n    csegment[offset++] = 0xFF;\n    csegment[offset++] = 0xFE;\n    csegment[offset++] = ((comment.length + 3) >>> 8) & 0xFF;\n    csegment[offset++] = (comment.length + 3) & 0xFF;\n\n    comment.split('').forEach(function (c) {\n      csegment[offset++] = c.charCodeAt(0) & 0xFF;\n    });\n\n    csegment[offset++] = 0;\n    comment_inserted = true;\n\n    return [ csegment, jpeg_bin.subarray(segment.offset, segment.offset + segment.length) ];\n  });\n};\n});\n\nfunction jpeg_patch_exif(env) {\n  return this._getUint8Array(env.blob).then(function (data) {\n    env.is_jpeg = image_traverse.is_jpeg(data);\n\n    if (!env.is_jpeg) return Promise.resolve(env);\n\n    env.orig_blob = env.blob;\n\n    try {\n      var exif_is_big_endian, orientation_offset;\n\n      /* eslint-disable consistent-return */\n      image_traverse.jpeg_exif_tags_each(data, function (entry) {\n        if (entry.ifd === 0 && entry.tag === 0x112 && Array.isArray(entry.value)) {\n          env.orientation    = entry.value[0] || 1;\n          exif_is_big_endian = entry.is_big_endian;\n          orientation_offset = entry.data_offset;\n          return false;\n        }\n      });\n\n      if (orientation_offset) {\n        var orientation_patch = exif_is_big_endian ?\n          new Uint8Array([ 0, 1 ]) :\n          new Uint8Array([ 1, 0 ]);\n\n        env.blob = new Blob([\n          data.slice(0, orientation_offset),\n          orientation_patch,\n          data.slice(orientation_offset + 2)\n        ], { type: 'image/jpeg' });\n      }\n    } catch (_) {}\n\n    return env;\n  });\n}\n\n\nfunction jpeg_rotate_canvas(env) {\n  if (!env.is_jpeg) return Promise.resolve(env);\n\n  var orientation = env.orientation - 1;\n  if (!orientation) return Promise.resolve(env);\n\n  var canvas;\n\n  if (orientation & 4) {\n    canvas = this.pica.options.createCanvas(env.out_canvas.height, env.out_canvas.width);\n  } else {\n    canvas = this.pica.options.createCanvas(env.out_canvas.width, env.out_canvas.height);\n  }\n\n  var ctx = canvas.getContext('2d');\n\n  ctx.save();\n\n  if (orientation & 1) ctx.transform(-1, 0, 0, 1, canvas.width, 0);\n  if (orientation & 2) ctx.transform(-1, 0, 0, -1, canvas.width, canvas.height);\n  if (orientation & 4) ctx.transform(0, 1, 1, 0, 0, 0);\n\n  ctx.drawImage(env.out_canvas, 0, 0);\n  ctx.restore();\n\n  // Safari 12 workaround\n  // https://github.com/nodeca/pica/issues/199\n  env.out_canvas.width = env.out_canvas.height = 0;\n\n  env.out_canvas = canvas;\n\n  return Promise.resolve(env);\n}\n\n\nfunction jpeg_attach_orig_segments(env) {\n  if (!env.is_jpeg) return Promise.resolve(env);\n\n  return Promise.all([\n    this._getUint8Array(env.blob),\n    this._getUint8Array(env.out_blob)\n  ]).then(function (res) {\n    var data = res[0];\n    var data_out = res[1];\n\n    if (!image_traverse.is_jpeg(data)) return Promise.resolve(env);\n\n    var segments = [];\n\n    image_traverse.jpeg_segments_each(data, function (segment) {\n      if (segment.code === 0xDA /* SOS */) return false;\n      segments.push(segment);\n    });\n\n    segments = segments\n      .filter(function (segment) {\n        // Drop ICC_PROFILE\n        //\n        if (segment.code === 0xE2) return false;\n\n        // Keep all APPn segments excluding APP2 (ICC_PROFILE),\n        // remove others because most of them depend on image data (DCT and such).\n        //\n        // APP0 - JFIF, APP1 - Exif, the rest are photoshop metadata and such\n        //\n        // See full list at https://www.w3.org/Graphics/JPEG/itu-t81.pdf (table B.1 on page 32)\n        //\n        if (segment.code >= 0xE0 && segment.code < 0xF0) return true;\n\n        // Keep comments\n        //\n        if (segment.code === 0xFE) return true;\n\n        return false;\n      })\n      .map(function (segment) {\n        return data.slice(segment.offset, segment.offset + segment.length);\n      });\n\n    env.out_blob = new Blob(\n      // intentionally omitting expected JFIF segment (offset 2 to 20)\n      [ data_out.slice(0, 2) ].concat(segments).concat([ data_out.slice(20) ]),\n      { type: 'image/jpeg' }\n    );\n\n    return env;\n  });\n}\n\n\nfunction assign(reducer) {\n  reducer.before('_blob_to_image', jpeg_patch_exif);\n  reducer.after('_transform',      jpeg_rotate_canvas);\n  reducer.after('_create_blob',    jpeg_attach_orig_segments);\n}\n\n\nvar jpeg_patch_exif_1 = jpeg_patch_exif;\nvar jpeg_rotate_canvas_1 = jpeg_rotate_canvas;\nvar jpeg_attach_orig_segments_1 = jpeg_attach_orig_segments;\nvar assign_1 = assign;\n\nvar jpeg_plugins = {\n\tjpeg_patch_exif: jpeg_patch_exif_1,\n\tjpeg_rotate_canvas: jpeg_rotate_canvas_1,\n\tjpeg_attach_orig_segments: jpeg_attach_orig_segments_1,\n\tassign: assign_1\n};\n\nfunction ImageBlobReduce(options) {\n  if (!(this instanceof ImageBlobReduce)) return new ImageBlobReduce(options);\n\n  options = options || {};\n\n  this.pica = options.pica || pica({});\n  this.initialized = false;\n\n  this.utils = utils;\n}\n\n\nImageBlobReduce.prototype.use = function (plugin /*, params, ... */) {\n  var args = [ this ].concat(Array.prototype.slice.call(arguments, 1));\n  plugin.apply(plugin, args);\n  return this;\n};\n\n\nImageBlobReduce.prototype.init = function () {\n  this.use(jpeg_plugins.assign);\n};\n\n\nImageBlobReduce.prototype.toBlob = function (blob, options) {\n  var opts = utils.assign({ max: Infinity }, options);\n  var env = {\n    blob: blob,\n    opts: opts\n  };\n\n  if (!this.initialized) {\n    this.init();\n    this.initialized = true;\n  }\n\n  return Promise.resolve(env)\n    .then(this._blob_to_image)\n    .then(this._calculate_size)\n    .then(this._transform)\n    .then(this._cleanup)\n    .then(this._create_blob)\n    .then(function (_env) {\n      // Safari 12 workaround\n      // https://github.com/nodeca/pica/issues/199\n      _env.out_canvas.width = _env.out_canvas.height = 0;\n\n      return _env.out_blob;\n    });\n};\n\n\nImageBlobReduce.prototype.toCanvas = function (blob, options) {\n  var opts = utils.assign({ max: Infinity }, options);\n  var env = {\n    blob: blob,\n    opts: opts\n  };\n\n  if (!this.initialized) {\n    this.init();\n    this.initialized = true;\n  }\n\n  return Promise.resolve(env)\n    .then(this._blob_to_image)\n    .then(this._calculate_size)\n    .then(this._transform)\n    .then(this._cleanup)\n    .then(function (_env) { return _env.out_canvas; });\n};\n\n\nImageBlobReduce.prototype.before = function (method_name, fn) {\n  if (!this[method_name]) throw new Error('Method \"' + method_name + '\" does not exist');\n  if (typeof fn !== 'function') throw new Error('Invalid argument \"fn\", function expected');\n\n  var old_fn = this[method_name];\n  var self = this;\n\n  this[method_name] = function (env) {\n    return fn.call(self, env).then(function (_env) {\n      return old_fn.call(self, _env);\n    });\n  };\n\n  return this;\n};\n\n\nImageBlobReduce.prototype.after = function (method_name, fn) {\n  if (!this[method_name]) throw new Error('Method \"' + method_name + '\" does not exist');\n  if (typeof fn !== 'function') throw new Error('Invalid argument \"fn\", function expected');\n\n  var old_fn = this[method_name];\n  var self = this;\n\n  this[method_name] = function (env) {\n    return old_fn.call(self, env).then(function (_env) {\n      return fn.call(self, _env);\n    });\n  };\n\n  return this;\n};\n\n\nImageBlobReduce.prototype._blob_to_image = function (env) {\n  var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n  env.image = document.createElement('img');\n  env.image_url = URL.createObjectURL(env.blob);\n  env.image.src = env.image_url;\n\n  return new Promise(function (resolve, reject) {\n    env.image.onerror = function () { reject(new Error('ImageBlobReduce: failed to create Image() from blob')); };\n    env.image.onload = function () { resolve(env); };\n  });\n};\n\n\nImageBlobReduce.prototype._calculate_size = function (env) {\n  //\n  // Note, if your need not \"symmetric\" resize logic, you MUST check\n  // `env.orientation` (set by plugins) and swap width/height appropriately.\n  //\n  var scale_factor = env.opts.max / Math.max(env.image.width, env.image.height);\n\n  if (scale_factor > 1) scale_factor = 1;\n\n  env.transform_width = Math.max(Math.round(env.image.width * scale_factor), 1);\n  env.transform_height = Math.max(Math.round(env.image.height * scale_factor), 1);\n\n  // Info for user plugins, to check if scaling applied\n  env.scale_factor = scale_factor;\n\n  return Promise.resolve(env);\n};\n\n\nImageBlobReduce.prototype._transform = function (env) {\n  env.out_canvas = this.pica.options.createCanvas(env.transform_width, env.transform_height);\n\n  // Dim env temporary vars to prohibit use and avoid confusion when orientation\n  // changed. You should take real size from canvas.\n  env.transform_width = null;\n  env.transform_height = null;\n\n  // By default use alpha for png only\n  var pica_opts = { alpha: env.blob.type === 'image/png' };\n\n  // Extract pica options if been passed\n  this.utils.assign(pica_opts, this.utils.pick_pica_resize_options(env.opts));\n\n  return this.pica\n    .resize(env.image, env.out_canvas, pica_opts)\n    .then(function () { return env; });\n};\n\n\nImageBlobReduce.prototype._cleanup = function (env) {\n  env.image.src = '';\n  env.image = null;\n\n  var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n  if (URL.revokeObjectURL) URL.revokeObjectURL(env.image_url);\n\n  env.image_url = null;\n\n  return Promise.resolve(env);\n};\n\n\nImageBlobReduce.prototype._create_blob = function (env) {\n  return this.pica.toBlob(env.out_canvas, env.blob.type)\n    .then(function (blob) {\n      env.out_blob = blob;\n      return env;\n    });\n};\n\n\nImageBlobReduce.prototype._getUint8Array = function (blob) {\n  if (blob.arrayBuffer) {\n    return blob.arrayBuffer().then(function (buf) {\n      return new Uint8Array(buf);\n    });\n  }\n\n  return new Promise(function (resolve, reject) {\n    var fr = new FileReader();\n\n    fr.readAsArrayBuffer(blob);\n\n    fr.onload = function () { resolve(new Uint8Array(fr.result)); };\n    fr.onerror = function () {\n      reject(new Error('ImageBlobReduce: failed to load data from input blob'));\n      fr.abort();\n    };\n    fr.onabort = function () {\n      reject(new Error('ImageBlobReduce: failed to load data from input blob (aborted)'));\n    };\n  });\n};\n\n\nImageBlobReduce.pica = pica;\n\nvar imageBlobReduce = ImageBlobReduce;\n\nexport default imageBlobReduce;\n"],"names":["reduce","reduceImport","$8891efa41e2f53e1$export$2e2bcd8739ae039","handleImage","source","callback","fileSize","size","test","navigator","userAgent","window","MSStream","console","warn","type","match","toBlob","max","unsharpAmount","unsharpRadius","quality","then","blob","error","$82195e271c44086f$var$pick","from","props","to","forEach","key","Object","prototype","hasOwnProperty","call","$82195e271c44086f$var$utils","assign","s","arguments","length","pick","pick_pica_resize_options","$82195e271c44086f$var$createCommonjsModule","fn","module","exports","$82195e271c44086f$var$commonjsRequire","target","Error","$82195e271c44086f$var$pica","r","e","n","t","o","i","f","u","a","code","p","_dereq_","inherits","Multimath","mm_unsharp_mask","mm_resize","MathLib","requested_features","__requested_features","features","js","indexOf","wasm","this","has_wasm","use","resizeAndUnsharp","options","cache","result","resize","unsharp_mask","toWidth","toHeight","unsharpThreshold","multimath","clampTo8","convolveHorizontally","src","dest","srcW","srcH","destW","filters","g","b","filterPtr","filterShift","filterSize","srcPtr","srcY","destX","filterVal","srcOffset","destOffset","convolveVertically","name","wasm_fn","wasm_src","createFilters","resetAlpha","dst","width","height","ptr","len","destH","scaleX","scaleY","offsetX","offsetY","Uint8Array","alpha","filtersX","filtersY","tmp","FILTER_INFO","FIXED_FRAC_BITS","toFixedPoint","num","Math","round","srcSize","destSize","scale","offset","destPixel","srcPixel","srcFirst","srcLast","filterElementSize","floatFilter","fxpFilter","total","pxl","idx","floatVal","filterTotal","leftNotEmpty","rightNotEmpty","filterFunction","filter","scaleInverted","scaleClamped","min","srcWindow","win","maxFilterElementSize","floor","packedFilter","Int16Array","packedFilterPtr","slowCopy","subarray","set","ceil","Float32Array","x","xpi","PI","sin","cos","asUint8Array","buffer","byteLength","IS_LE","Uint32Array","__","copyInt16asLE","target_offset","data","src_offset","tmp_offset","__align","filtersX_offset","filtersY_offset","alloc_bytes","instance","__instance","mem","__memory","mem32","src32","convolveHV","_convolveHV","glur_mono16","hsv_v16","img","out","Uint16Array","amount","radius","threshold","v1","v2","vmul","diff","iTimes4","brightness","blured","amountFp","thresholdFp","abs","pixels","img_bytes_cnt","hsv_bytes_cnt","blur_bytes_cnt","blur_line_byte_cnt","blur_coeffs_byte_cnt","img_offset","hsv_offset","blur_offset","blur_tmp_offset","blur_line_offset","blur_coeffs_offset","exp","img32","_hsv_v16","blurMono16","_blurMono16","unsharp","_unsharp","GC_INTERVAL","Pool","create","idle","available","acquired","lastId","timeoutId","acquire","resource","_this","pop","id","release","_this2","lastUsed","Date","now","push","setTimeout","gc","_this3","destroy","MIN_INNER_TILE_SIZE","fromWidth","fromHeight","srcTileSize","destTileBorder","minScale","stageCount","log","pow","PIXEL_EPSILON","pixelFloor","nearest","pixelCeil","y","innerX","innerY","toTileWidth","toTileHeight","innerTileWidth","innerTileHeight","tile","tiles","toX","toY","toInnerX","toInnerY","toInnerWidth","toInnerHeight","objClass","obj","toString","isCanvas","element","cname","isImage","isImageBitmap","limiter","concurrency","active","queue","roll","shift","Promise","resolve","reject","err","cib_quality_name","cib_support","createCanvas","createImageBitmap","c","resizeWidth","resizeHeight","resizeQuality","bitmap","status","close","worker_offscreen_canvas_support","OffscreenCanvas","btoa","concat","workerPayload","w","Worker","onmessage","ev","onerror","self","canvas","getContext","rect","postMessage","can_use_canvas","usable","ctx","d","createImageData","putImageData","getImageData","cib_can_use_region","image","Image","onload","mathLib","tileOpts","opts","returnBitmap","srcBitmap","Boolean","drawImage","toImageData","ImageData","Uint8ClampedArray","_canvas","a0","a1","a2","a3","b1","b2","gaussCoef","sigma","g1","g2","k","convolveMono16","line","coeff","prev_src","curr_src","curr_out","prev_out","prev_prev_out","src_index","out_index","line_index","j","coeff_a0","coeff_a1","coeff_b1","coeff_b2","tmp_line","ctor","superCtor","super_","constructor","value","enumerable","writable","configurable","TempCtor","base64decode","hasWebAssembly","DEFAULT_OPTIONS","MultiMath","__cache","__init_promise","__modules","modules","__wasm","__isLE","init","all","keys","map","WebAssembly","compile","__base64decode","m","__reallocate","bytes","Memory","initial","mem_size","grow","memsize","env_extra","Module","env_base","memoryBase","memory","tableBase","table","Table","Instance","env","number","base","reminder","BASE64_MAP","str","input","replace","bits","charAt","tailbits","wa","bin","getOwnPropertySymbols","propIsEnumerable","propertyIsEnumerable","toObject","val","TypeError","shouldUseNative","test1","getOwnPropertyNames","test2","String","fromCharCode","join","test3","split","letter","symbols","bundleFn","sources","stringify","JSON","wkey","cacheKeys","l","default","random","wcache","skey","scache","workerSources","resolveSources","depPath","depKey","URL","webkitURL","mozURL","msURL","Blob","bare","workerUrl","createObjectURL","worker","objectURL","_slicedToArray","arr","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","minLen","_arrayLikeToArray","slice","Array","arr2","_i","Symbol","iterator","_s","_e","_arr","_n","_d","next","done","isArray","webworkify","utils","createStages","createRegions","singletones","NEED_SAFARI_FIX","hardwareConcurrency","DEFAULT_PICA_OPTS","tmpCanvas","document","createElement","DEFAULT_RESIZE_OPTS","CAN_NEW_IMAGE_DATA","CAN_CREATE_IMAGE_BITMAP","CAN_USE_CANVAS_GET_IMAGE_DATA","CAN_USE_OFFSCREEN_CANVAS","CAN_USE_CIB_REGION_FOR_IMAGE","workerFabric","terminate","url","revokeObjectURL","Pica","limiter_key","__limit","cib","ww","__workersPool","__mathlib","__initPromise","ImageBitmap","debug","wpool_key","checkCibResize","checkOffscreenCanvas","initMath","mathlib","checkCibRegion","__invokeResize","__mathCache","cancelToken","transfer","preload","wasm_nodule","__extractTileData","stageEnv","extractTo","srcImageBitmap","srcCtx","tmpCtx","globalCompositeOperation","__landTileData","toCtx","__tileAndResize","isImageBitmapReused","processTile","canceled","srcImageData","imageBitmap","jobs","__destTileBorder","cleanup","__processStages","stages","_this4","_stages$shift2","isLastStage","res","__resizeViaCreateImageBitmap","_this5","iData","_this6","isNaN","naturalWidth","naturalHeight","DEST_TILE_BORDER","resizeBuffer","_this7","mimeType","convertToBlob","asString","atob","toDataURL","asBuffer","charCodeAt","$82195e271c44086f$var$image_traverse","message","to_hex","toUpperCase","utf8_decode","decodeURIComponent","escape","_","is_uint8array","ExifParser","jpeg_bin","exif_start","exif_end","start","sig","apply","big_endian","each","on_entry","aborted","read_uint32","ifds_to_read","scan_ifd","ifds","entries","entry","is_subifd_link","count","format","ifd","ifd1","ifd_no","data_length","output","write_uint16","write_uint32","written_offset","ifd_start","ifd_end","sort","tag","entry_offset","link_offset","data_offset","next_ifd","read_uint16","exif_format_length","exif_format_read","v","entry_count","comp_length","comp_offset","item","Number","isInteger","is_big_endian","is_jpeg","jpeg_segments_each","on_segment","inside_scan","segment_code","segment_length","byte1","byte2","pos","jpeg_segments_filter","ranges","out_length","segment","new_segment","new_range","end","range","jpeg_exif_tags_each","on_exif_entry","jpeg_exif_tags_filter","stop_search","new_exif","header","jpeg_add_comment","comment","comment_inserted","segment_count","unescape","encodeURIComponent","utf8_encode","csegment","$82195e271c44086f$var$jpeg_patch_exif","_getUint8Array","orig_blob","exif_is_big_endian","orientation_offset","orientation","orientation_patch","$82195e271c44086f$var$jpeg_rotate_canvas","pica","out_canvas","save","transform","restore","$82195e271c44086f$var$jpeg_attach_orig_segments","out_blob","data_out","segments","$82195e271c44086f$var$jpeg_plugins","jpeg_patch_exif","jpeg_rotate_canvas","jpeg_attach_orig_segments","reducer","before","after","$82195e271c44086f$var$ImageBlobReduce","initialized","plugin","args","Infinity","_blob_to_image","_calculate_size","_transform","_cleanup","_create_blob","_env","toCanvas","method_name","old_fn","image_url","scale_factor","transform_width","transform_height","pica_opts","arrayBuffer","buf","fr","FileReader","readAsArrayBuffer","abort","onabort","$82195e271c44086f$export$2e2bcd8739ae039"],"version":3,"file":"image-service.929466c7.js.map"}